{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Evaluator = exports.ExpressionError = exports.EvaluationError = exports.EvaluationErrorType = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar constants_1 = require(\"./constants\");\n\nvar error_1 = require(\"./error\");\n\nvar sourceLocation_1 = require(\"./sourceLocation\");\n\nvar EvaluationErrorType;\n\n(function (EvaluationErrorType) {\n  EvaluationErrorType[\"TIMEOUT\"] = \"https://croct.help/api/evaluation#timeout\";\n  EvaluationErrorType[\"UNEXPECTED_ERROR\"] = \"https://croct.help/api/evaluation#unexpected-error\";\n  EvaluationErrorType[\"INVALID_EXPRESSION\"] = \"https://croct.help/api/evaluation#invalid-expression\";\n  EvaluationErrorType[\"TOO_COMPLEX_EXPRESSION\"] = \"https://croct.help/api/evaluation#too-complex-expression\";\n  EvaluationErrorType[\"EVALUATION_FAILED\"] = \"https://croct.help/api/evaluation#evaluation-failed\";\n  EvaluationErrorType[\"UNALLOWED_RESULT\"] = \"https://croct.help/api/evaluation#unallowed-result\";\n  EvaluationErrorType[\"UNSERIALIZABLE_RESULT\"] = \"https://croct.help/api/evaluation#unserializable-result\";\n})(EvaluationErrorType = exports.EvaluationErrorType || (exports.EvaluationErrorType = {}));\n\nvar EvaluationError =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(EvaluationError, _super);\n\n  function EvaluationError(response) {\n    var _this = _super.call(this, response.title) || this;\n\n    _this.response = response;\n    Object.setPrototypeOf(_this, EvaluationError.prototype);\n    return _this;\n  }\n\n  return EvaluationError;\n}(Error);\n\nexports.EvaluationError = EvaluationError;\n\nvar ExpressionError =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(ExpressionError, _super);\n\n  function ExpressionError(response) {\n    var _this = _super.call(this, response) || this;\n\n    Object.setPrototypeOf(_this, ExpressionError.prototype);\n    return _this;\n  }\n\n  return ExpressionError;\n}(EvaluationError);\n\nexports.ExpressionError = ExpressionError;\n\nvar Evaluator =\n/** @class */\nfunction () {\n  function Evaluator(configuration) {\n    var _a;\n\n    this.configuration = tslib_1.__assign(tslib_1.__assign({}, configuration), {\n      endpointUrl: (_a = configuration.endpointUrl) !== null && _a !== void 0 ? _a : constants_1.EVALUATION_ENDPOINT_URL\n    });\n  }\n\n  Evaluator.prototype.evaluate = function (expression, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var length, response, endpoint;\n\n      var _this = this;\n\n      return tslib_1.__generator(this, function (_a) {\n        length = (0, sourceLocation_1.getLength)(expression);\n\n        if (length > Evaluator.MAX_EXPRESSION_LENGTH) {\n          response = {\n            title: 'The expression is too complex.',\n            status: 422,\n            type: EvaluationErrorType.TOO_COMPLEX_EXPRESSION,\n            detail: \"The expression must be at most \".concat(Evaluator.MAX_EXPRESSION_LENGTH, \" characters long, \") + \"but it is \".concat(length, \" characters long.\"),\n            errors: [{\n              cause: 'The expression is longer than expected.',\n              location: (0, sourceLocation_1.getLocation)(expression, 0, Math.max(length - 1, 0))\n            }]\n          };\n          return [2\n          /*return*/\n          , Promise.reject(new ExpressionError(response))];\n        }\n\n        endpoint = new URL(this.configuration.endpointUrl);\n        endpoint.searchParams.append('expression', expression);\n\n        if (options.context !== undefined) {\n          endpoint.searchParams.append('context', JSON.stringify(options.context));\n        }\n\n        return [2\n        /*return*/\n        , new Promise(function (resolve, reject) {\n          if (options.timeout !== undefined) {\n            window.setTimeout(function () {\n              var response = {\n                title: 'Maximum evaluation timeout reached before evaluation could complete.',\n                type: EvaluationErrorType.TIMEOUT,\n                detail: \"The evaluation took more than \".concat(options.timeout, \"ms to complete.\"),\n                status: 408 // Request Timeout\n\n              };\n              reject(new EvaluationError(response));\n            }, options.timeout);\n          }\n\n          var promise = _this.fetch(endpoint.toString());\n\n          promise.then(function (response) {\n            if (response.ok) {\n              response.json().then(resolve);\n              return;\n            }\n\n            response.json().then(function (result) {\n              var errorResponse = result;\n\n              switch (errorResponse.type) {\n                case EvaluationErrorType.INVALID_EXPRESSION:\n                case EvaluationErrorType.EVALUATION_FAILED:\n                case EvaluationErrorType.TOO_COMPLEX_EXPRESSION:\n                  reject(new ExpressionError(errorResponse));\n                  break;\n\n                default:\n                  reject(new EvaluationError(errorResponse));\n                  break;\n              }\n            });\n          }, function (error) {\n            var errorResponse = {\n              title: (0, error_1.formatMessage)(error),\n              type: EvaluationErrorType.UNEXPECTED_ERROR,\n              detail: 'Please try again or contact Croct support if the error persists.',\n              status: 500 // Internal Server Error\n\n            };\n            reject(new EvaluationError(errorResponse));\n          });\n        })];\n      });\n    });\n  };\n\n  Evaluator.prototype.fetch = function (endpoint) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _a, tokenProvider, cidAssigner, appId, token, cid, headers;\n\n      return tslib_1.__generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _a = this.configuration, tokenProvider = _a.tokenProvider, cidAssigner = _a.cidAssigner, appId = _a.appId;\n            token = tokenProvider.getToken();\n            return [4\n            /*yield*/\n            , cidAssigner.assignCid()];\n\n          case 1:\n            cid = _b.sent();\n            headers = tslib_1.__assign({\n              'X-App-Id': appId,\n              'X-Client-Id': cid\n            }, token !== null && {\n              'X-Token': token.toString()\n            });\n            return [2\n            /*return*/\n            , window.fetch(endpoint.toString(), {\n              method: 'GET',\n              headers: headers,\n              credentials: 'include'\n            })];\n        }\n      });\n    });\n  };\n\n  Evaluator.MAX_EXPRESSION_LENGTH = constants_1.MAX_EXPRESSION_LENGTH;\n  return Evaluator;\n}();\n\nexports.Evaluator = Evaluator;","map":{"version":3,"names":["Object","defineProperty","exports","value","Evaluator","ExpressionError","EvaluationError","EvaluationErrorType","tslib_1","require","constants_1","error_1","sourceLocation_1","_super","__extends","response","_this","call","title","setPrototypeOf","prototype","Error","configuration","_a","__assign","endpointUrl","EVALUATION_ENDPOINT_URL","evaluate","expression","options","__awaiter","length","endpoint","__generator","getLength","MAX_EXPRESSION_LENGTH","status","type","TOO_COMPLEX_EXPRESSION","detail","concat","errors","cause","location","getLocation","Math","max","Promise","reject","URL","searchParams","append","context","undefined","JSON","stringify","resolve","timeout","window","setTimeout","TIMEOUT","promise","fetch","toString","then","ok","json","result","errorResponse","INVALID_EXPRESSION","EVALUATION_FAILED","error","formatMessage","UNEXPECTED_ERROR","tokenProvider","cidAssigner","appId","token","cid","headers","_b","label","getToken","assignCid","sent","method","credentials"],"sources":["C:/Users/User/croct/node_modules/@croct/sdk/evaluator.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Evaluator = exports.ExpressionError = exports.EvaluationError = exports.EvaluationErrorType = void 0;\nvar tslib_1 = require(\"tslib\");\nvar constants_1 = require(\"./constants\");\nvar error_1 = require(\"./error\");\nvar sourceLocation_1 = require(\"./sourceLocation\");\nvar EvaluationErrorType;\n(function (EvaluationErrorType) {\n    EvaluationErrorType[\"TIMEOUT\"] = \"https://croct.help/api/evaluation#timeout\";\n    EvaluationErrorType[\"UNEXPECTED_ERROR\"] = \"https://croct.help/api/evaluation#unexpected-error\";\n    EvaluationErrorType[\"INVALID_EXPRESSION\"] = \"https://croct.help/api/evaluation#invalid-expression\";\n    EvaluationErrorType[\"TOO_COMPLEX_EXPRESSION\"] = \"https://croct.help/api/evaluation#too-complex-expression\";\n    EvaluationErrorType[\"EVALUATION_FAILED\"] = \"https://croct.help/api/evaluation#evaluation-failed\";\n    EvaluationErrorType[\"UNALLOWED_RESULT\"] = \"https://croct.help/api/evaluation#unallowed-result\";\n    EvaluationErrorType[\"UNSERIALIZABLE_RESULT\"] = \"https://croct.help/api/evaluation#unserializable-result\";\n})(EvaluationErrorType = exports.EvaluationErrorType || (exports.EvaluationErrorType = {}));\nvar EvaluationError = /** @class */ (function (_super) {\n    tslib_1.__extends(EvaluationError, _super);\n    function EvaluationError(response) {\n        var _this = _super.call(this, response.title) || this;\n        _this.response = response;\n        Object.setPrototypeOf(_this, EvaluationError.prototype);\n        return _this;\n    }\n    return EvaluationError;\n}(Error));\nexports.EvaluationError = EvaluationError;\nvar ExpressionError = /** @class */ (function (_super) {\n    tslib_1.__extends(ExpressionError, _super);\n    function ExpressionError(response) {\n        var _this = _super.call(this, response) || this;\n        Object.setPrototypeOf(_this, ExpressionError.prototype);\n        return _this;\n    }\n    return ExpressionError;\n}(EvaluationError));\nexports.ExpressionError = ExpressionError;\nvar Evaluator = /** @class */ (function () {\n    function Evaluator(configuration) {\n        var _a;\n        this.configuration = tslib_1.__assign(tslib_1.__assign({}, configuration), { endpointUrl: (_a = configuration.endpointUrl) !== null && _a !== void 0 ? _a : constants_1.EVALUATION_ENDPOINT_URL });\n    }\n    Evaluator.prototype.evaluate = function (expression, options) {\n        if (options === void 0) { options = {}; }\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var length, response, endpoint;\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                length = (0, sourceLocation_1.getLength)(expression);\n                if (length > Evaluator.MAX_EXPRESSION_LENGTH) {\n                    response = {\n                        title: 'The expression is too complex.',\n                        status: 422,\n                        type: EvaluationErrorType.TOO_COMPLEX_EXPRESSION,\n                        detail: \"The expression must be at most \".concat(Evaluator.MAX_EXPRESSION_LENGTH, \" characters long, \")\n                            + \"but it is \".concat(length, \" characters long.\"),\n                        errors: [{\n                                cause: 'The expression is longer than expected.',\n                                location: (0, sourceLocation_1.getLocation)(expression, 0, Math.max(length - 1, 0)),\n                            }],\n                    };\n                    return [2 /*return*/, Promise.reject(new ExpressionError(response))];\n                }\n                endpoint = new URL(this.configuration.endpointUrl);\n                endpoint.searchParams.append('expression', expression);\n                if (options.context !== undefined) {\n                    endpoint.searchParams.append('context', JSON.stringify(options.context));\n                }\n                return [2 /*return*/, new Promise(function (resolve, reject) {\n                        if (options.timeout !== undefined) {\n                            window.setTimeout(function () {\n                                var response = {\n                                    title: 'Maximum evaluation timeout reached before evaluation could complete.',\n                                    type: EvaluationErrorType.TIMEOUT,\n                                    detail: \"The evaluation took more than \".concat(options.timeout, \"ms to complete.\"),\n                                    status: 408, // Request Timeout\n                                };\n                                reject(new EvaluationError(response));\n                            }, options.timeout);\n                        }\n                        var promise = _this.fetch(endpoint.toString());\n                        promise.then(function (response) {\n                            if (response.ok) {\n                                response.json().then(resolve);\n                                return;\n                            }\n                            response.json().then(function (result) {\n                                var errorResponse = result;\n                                switch (errorResponse.type) {\n                                    case EvaluationErrorType.INVALID_EXPRESSION:\n                                    case EvaluationErrorType.EVALUATION_FAILED:\n                                    case EvaluationErrorType.TOO_COMPLEX_EXPRESSION:\n                                        reject(new ExpressionError(errorResponse));\n                                        break;\n                                    default:\n                                        reject(new EvaluationError(errorResponse));\n                                        break;\n                                }\n                            });\n                        }, function (error) {\n                            var errorResponse = {\n                                title: (0, error_1.formatMessage)(error),\n                                type: EvaluationErrorType.UNEXPECTED_ERROR,\n                                detail: 'Please try again or contact Croct support if the error persists.',\n                                status: 500, // Internal Server Error\n                            };\n                            reject(new EvaluationError(errorResponse));\n                        });\n                    })];\n            });\n        });\n    };\n    Evaluator.prototype.fetch = function (endpoint) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var _a, tokenProvider, cidAssigner, appId, token, cid, headers;\n            return tslib_1.__generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _a = this.configuration, tokenProvider = _a.tokenProvider, cidAssigner = _a.cidAssigner, appId = _a.appId;\n                        token = tokenProvider.getToken();\n                        return [4 /*yield*/, cidAssigner.assignCid()];\n                    case 1:\n                        cid = _b.sent();\n                        headers = tslib_1.__assign({ 'X-App-Id': appId, 'X-Client-Id': cid }, (token !== null && { 'X-Token': token.toString() }));\n                        return [2 /*return*/, window.fetch(endpoint.toString(), {\n                                method: 'GET',\n                                headers: headers,\n                                credentials: 'include',\n                            })];\n                }\n            });\n        });\n    };\n    Evaluator.MAX_EXPRESSION_LENGTH = constants_1.MAX_EXPRESSION_LENGTH;\n    return Evaluator;\n}());\nexports.Evaluator = Evaluator;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}
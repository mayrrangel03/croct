{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PersistentQueue = void 0;\n\nvar PersistentQueue =\n/** @class */\nfunction () {\n  function PersistentQueue(storage, key) {\n    if (key === void 0) {\n      key = 'queue';\n    }\n\n    this.storage = storage;\n    this.key = key;\n  }\n\n  PersistentQueue.prototype.all = function () {\n    return this.queue.slice();\n  };\n\n  PersistentQueue.prototype.getCapacity = function () {\n    return Infinity;\n  };\n\n  PersistentQueue.prototype.isEmpty = function () {\n    return this.length() === 0;\n  };\n\n  PersistentQueue.prototype.length = function () {\n    return this.queue.length;\n  };\n\n  PersistentQueue.prototype.push = function (value) {\n    this.queue.push(value);\n    this.flush();\n  };\n\n  PersistentQueue.prototype.peek = function () {\n    var item = this.queue[0];\n\n    if (item === undefined) {\n      return null;\n    }\n\n    return item;\n  };\n\n  PersistentQueue.prototype.shift = function () {\n    var value = this.queue.shift();\n\n    if (!value) {\n      throw new Error('The queue is empty.');\n    }\n\n    this.flush();\n    return value;\n  };\n\n  Object.defineProperty(PersistentQueue.prototype, \"queue\", {\n    get: function () {\n      if (!this.cache) {\n        this.cache = this.load();\n      }\n\n      return this.cache;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  PersistentQueue.prototype.flush = function () {\n    this.storage.setItem(this.key, JSON.stringify(this.cache || []));\n  };\n\n  PersistentQueue.prototype.load = function () {\n    var data = this.storage.getItem(this.key);\n\n    if (data === null) {\n      return [];\n    }\n\n    try {\n      return JSON.parse(data);\n    } catch (error) {\n      return [];\n    }\n  };\n\n  return PersistentQueue;\n}();\n\nexports.PersistentQueue = PersistentQueue;","map":{"version":3,"names":["Object","defineProperty","exports","value","PersistentQueue","storage","key","prototype","all","queue","slice","getCapacity","Infinity","isEmpty","length","push","flush","peek","item","undefined","shift","Error","get","cache","load","enumerable","configurable","setItem","JSON","stringify","data","getItem","parse","error"],"sources":["C:/Users/User/croct/node_modules/@croct/sdk/queue/persistentQueue.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PersistentQueue = void 0;\nvar PersistentQueue = /** @class */ (function () {\n    function PersistentQueue(storage, key) {\n        if (key === void 0) { key = 'queue'; }\n        this.storage = storage;\n        this.key = key;\n    }\n    PersistentQueue.prototype.all = function () {\n        return this.queue.slice();\n    };\n    PersistentQueue.prototype.getCapacity = function () {\n        return Infinity;\n    };\n    PersistentQueue.prototype.isEmpty = function () {\n        return this.length() === 0;\n    };\n    PersistentQueue.prototype.length = function () {\n        return this.queue.length;\n    };\n    PersistentQueue.prototype.push = function (value) {\n        this.queue.push(value);\n        this.flush();\n    };\n    PersistentQueue.prototype.peek = function () {\n        var item = this.queue[0];\n        if (item === undefined) {\n            return null;\n        }\n        return item;\n    };\n    PersistentQueue.prototype.shift = function () {\n        var value = this.queue.shift();\n        if (!value) {\n            throw new Error('The queue is empty.');\n        }\n        this.flush();\n        return value;\n    };\n    Object.defineProperty(PersistentQueue.prototype, \"queue\", {\n        get: function () {\n            if (!this.cache) {\n                this.cache = this.load();\n            }\n            return this.cache;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    PersistentQueue.prototype.flush = function () {\n        this.storage.setItem(this.key, JSON.stringify(this.cache || []));\n    };\n    PersistentQueue.prototype.load = function () {\n        var data = this.storage.getItem(this.key);\n        if (data === null) {\n            return [];\n        }\n        try {\n            return JSON.parse(data);\n        }\n        catch (error) {\n            return [];\n        }\n    };\n    return PersistentQueue;\n}());\nexports.PersistentQueue = PersistentQueue;\n"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;EAAEC,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,eAAR,GAA0B,KAAK,CAA/B;;AACA,IAAIA,eAAe;AAAG;AAAe,YAAY;EAC7C,SAASA,eAAT,CAAyBC,OAAzB,EAAkCC,GAAlC,EAAuC;IACnC,IAAIA,GAAG,KAAK,KAAK,CAAjB,EAAoB;MAAEA,GAAG,GAAG,OAAN;IAAgB;;IACtC,KAAKD,OAAL,GAAeA,OAAf;IACA,KAAKC,GAAL,GAAWA,GAAX;EACH;;EACDF,eAAe,CAACG,SAAhB,CAA0BC,GAA1B,GAAgC,YAAY;IACxC,OAAO,KAAKC,KAAL,CAAWC,KAAX,EAAP;EACH,CAFD;;EAGAN,eAAe,CAACG,SAAhB,CAA0BI,WAA1B,GAAwC,YAAY;IAChD,OAAOC,QAAP;EACH,CAFD;;EAGAR,eAAe,CAACG,SAAhB,CAA0BM,OAA1B,GAAoC,YAAY;IAC5C,OAAO,KAAKC,MAAL,OAAkB,CAAzB;EACH,CAFD;;EAGAV,eAAe,CAACG,SAAhB,CAA0BO,MAA1B,GAAmC,YAAY;IAC3C,OAAO,KAAKL,KAAL,CAAWK,MAAlB;EACH,CAFD;;EAGAV,eAAe,CAACG,SAAhB,CAA0BQ,IAA1B,GAAiC,UAAUZ,KAAV,EAAiB;IAC9C,KAAKM,KAAL,CAAWM,IAAX,CAAgBZ,KAAhB;IACA,KAAKa,KAAL;EACH,CAHD;;EAIAZ,eAAe,CAACG,SAAhB,CAA0BU,IAA1B,GAAiC,YAAY;IACzC,IAAIC,IAAI,GAAG,KAAKT,KAAL,CAAW,CAAX,CAAX;;IACA,IAAIS,IAAI,KAAKC,SAAb,EAAwB;MACpB,OAAO,IAAP;IACH;;IACD,OAAOD,IAAP;EACH,CAND;;EAOAd,eAAe,CAACG,SAAhB,CAA0Ba,KAA1B,GAAkC,YAAY;IAC1C,IAAIjB,KAAK,GAAG,KAAKM,KAAL,CAAWW,KAAX,EAAZ;;IACA,IAAI,CAACjB,KAAL,EAAY;MACR,MAAM,IAAIkB,KAAJ,CAAU,qBAAV,CAAN;IACH;;IACD,KAAKL,KAAL;IACA,OAAOb,KAAP;EACH,CAPD;;EAQAH,MAAM,CAACC,cAAP,CAAsBG,eAAe,CAACG,SAAtC,EAAiD,OAAjD,EAA0D;IACtDe,GAAG,EAAE,YAAY;MACb,IAAI,CAAC,KAAKC,KAAV,EAAiB;QACb,KAAKA,KAAL,GAAa,KAAKC,IAAL,EAAb;MACH;;MACD,OAAO,KAAKD,KAAZ;IACH,CANqD;IAOtDE,UAAU,EAAE,KAP0C;IAQtDC,YAAY,EAAE;EARwC,CAA1D;;EAUAtB,eAAe,CAACG,SAAhB,CAA0BS,KAA1B,GAAkC,YAAY;IAC1C,KAAKX,OAAL,CAAasB,OAAb,CAAqB,KAAKrB,GAA1B,EAA+BsB,IAAI,CAACC,SAAL,CAAe,KAAKN,KAAL,IAAc,EAA7B,CAA/B;EACH,CAFD;;EAGAnB,eAAe,CAACG,SAAhB,CAA0BiB,IAA1B,GAAiC,YAAY;IACzC,IAAIM,IAAI,GAAG,KAAKzB,OAAL,CAAa0B,OAAb,CAAqB,KAAKzB,GAA1B,CAAX;;IACA,IAAIwB,IAAI,KAAK,IAAb,EAAmB;MACf,OAAO,EAAP;IACH;;IACD,IAAI;MACA,OAAOF,IAAI,CAACI,KAAL,CAAWF,IAAX,CAAP;IACH,CAFD,CAGA,OAAOG,KAAP,EAAc;MACV,OAAO,EAAP;IACH;EACJ,CAXD;;EAYA,OAAO7B,eAAP;AACH,CA/DoC,EAArC;;AAgEAF,OAAO,CAACE,eAAR,GAA0BA,eAA1B"},"metadata":{},"sourceType":"script"}
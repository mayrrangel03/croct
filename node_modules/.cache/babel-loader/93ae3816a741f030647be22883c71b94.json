{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.StringType = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar schema_1 = require(\"./schema\");\n\nvar violation_1 = require(\"./violation\");\n\nvar FORMAT = {\n  pointer: function pointer(value) {\n    return /^(\\.|([a-zA-Z_][a-zA-Z0-9_]*|\\[[0-9]+])(\\.[a-zA-Z_][a-zA-Z0-9_]*|\\[[0-9]+])*)$/.test(value);\n  },\n  identifier: function identifier(value) {\n    return /^[a-zA-Z_][a-zA-Z0-9_]*$/.test(value);\n  },\n  uuid: function uuid(value) {\n    return /^[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(value);\n  },\n  date: function date(value) {\n    return /^(\\d\\d\\d\\d)-(\\d\\d)-(\\d\\d)$/.test(value);\n  },\n  url: function url(value) {\n    try {\n      // eslint-disable-next-line no-new\n      new URL(value);\n    } catch (_a) {\n      return false;\n    }\n\n    return true;\n  },\n  'uri-reference': function uriReference(value) {\n    try {\n      // This simplistic approach covers the most common cases\n      // without inflating the library with an RFC 3986-compliant parser.\n      // eslint-disable-next-line no-new\n      new URL(value, 'http://any.thing');\n    } catch (_a) {\n      return false;\n    }\n\n    return true;\n  }\n};\n\nvar StringType =\n/** @class */\nfunction () {\n  function StringType(definition) {\n    if (definition === void 0) {\n      definition = {};\n    }\n\n    var _a, _b, _c;\n\n    this.definition = tslib_1.__assign(tslib_1.__assign({}, definition), {\n      minLength: (_a = definition.minLength) !== null && _a !== void 0 ? _a : -1,\n      maxLength: (_b = definition.maxLength) !== null && _b !== void 0 ? _b : -1,\n      enumeration: (_c = definition.enumeration) !== null && _c !== void 0 ? _c : []\n    });\n  }\n\n  StringType.prototype.getTypes = function () {\n    return ['string'];\n  };\n\n  StringType.prototype.isValidType = function (value) {\n    return typeof value === 'string';\n  };\n\n  StringType.prototype.validate = function (value, path) {\n    if (path === void 0) {\n      path = [];\n    }\n\n    if (!this.isValidType(value)) {\n      throw new schema_1.Violation(\"Expected value of type string at path '\".concat((0, violation_1.formatPath)(path), \"', actual \").concat((0, violation_1.describe)(value), \".\"), path, {\n        type: 'string'\n      });\n    }\n\n    var _a = this.definition,\n        minLength = _a.minLength,\n        maxLength = _a.maxLength;\n\n    if (minLength >= 0 && minLength > value.length) {\n      throw new schema_1.Violation(\"Expected \".concat(minLength === maxLength ? 'exactly' : 'at least', \" \") + \"\".concat(minLength, \" \").concat(minLength === 1 ? 'character' : 'characters', \" \") + \"at path '\".concat((0, violation_1.formatPath)(path), \"', actual \").concat(value.length, \".\"), path, {\n        limit: minLength\n      });\n    }\n\n    if (maxLength >= 0 && maxLength < value.length) {\n      throw new schema_1.Violation(\"Expected \".concat(minLength === maxLength ? 'exactly' : 'at most', \" \") + \"\".concat(maxLength, \" \").concat(maxLength === 1 ? 'character' : 'characters', \" \") + \"at path '\".concat((0, violation_1.formatPath)(path), \"', actual \").concat(value.length, \".\"), path, {\n        limit: maxLength\n      });\n    }\n\n    var enumeration = this.definition.enumeration;\n\n    if (enumeration.length > 0 && enumeration.indexOf(value) < 0) {\n      throw new schema_1.Violation(\"Unexpected value at path '\".concat((0, violation_1.formatPath)(path), \"', expecting \") + \"'\".concat(enumeration.length === 1 ? enumeration[0] : \"\".concat(enumeration.slice(0, -1).join('\\', \\''), \"' or '\").concat(enumeration.slice(-1)), \"', \") + \"found '\".concat(value, \"'.\"), path, {\n        enumeration: enumeration\n      });\n    }\n\n    var _b = this.definition,\n        format = _b.format,\n        pattern = _b.pattern;\n\n    if (format !== undefined && !FORMAT[format](value)) {\n      throw new schema_1.Violation(\"Invalid \".concat(format, \" format at path '\").concat((0, violation_1.formatPath)(path), \"'.\"), path, {\n        format: format\n      });\n    }\n\n    if (pattern !== undefined && !pattern.test(value)) {\n      throw new schema_1.Violation(\"Invalid format at path '\".concat((0, violation_1.formatPath)(path), \"'.\"), path, {\n        pattern: pattern\n      });\n    }\n  };\n\n  return StringType;\n}();\n\nexports.StringType = StringType;","map":{"version":3,"names":["Object","defineProperty","exports","value","StringType","tslib_1","require","schema_1","violation_1","FORMAT","pointer","test","identifier","uuid","date","url","URL","_a","uriReference","definition","_b","_c","__assign","minLength","maxLength","enumeration","prototype","getTypes","isValidType","validate","path","Violation","concat","formatPath","describe","type","length","limit","indexOf","slice","join","format","pattern","undefined"],"sources":["C:/Users/User/croct/node_modules/@croct/sdk/validation/stringType.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.StringType = void 0;\nvar tslib_1 = require(\"tslib\");\nvar schema_1 = require(\"./schema\");\nvar violation_1 = require(\"./violation\");\nvar FORMAT = {\n    pointer: function pointer(value) {\n        return /^(\\.|([a-zA-Z_][a-zA-Z0-9_]*|\\[[0-9]+])(\\.[a-zA-Z_][a-zA-Z0-9_]*|\\[[0-9]+])*)$/.test(value);\n    },\n    identifier: function identifier(value) {\n        return /^[a-zA-Z_][a-zA-Z0-9_]*$/.test(value);\n    },\n    uuid: function uuid(value) {\n        return /^[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(value);\n    },\n    date: function date(value) {\n        return /^(\\d\\d\\d\\d)-(\\d\\d)-(\\d\\d)$/.test(value);\n    },\n    url: function url(value) {\n        try {\n            // eslint-disable-next-line no-new\n            new URL(value);\n        }\n        catch (_a) {\n            return false;\n        }\n        return true;\n    },\n    'uri-reference': function uriReference(value) {\n        try {\n            // This simplistic approach covers the most common cases\n            // without inflating the library with an RFC 3986-compliant parser.\n            // eslint-disable-next-line no-new\n            new URL(value, 'http://any.thing');\n        }\n        catch (_a) {\n            return false;\n        }\n        return true;\n    },\n};\nvar StringType = /** @class */ (function () {\n    function StringType(definition) {\n        if (definition === void 0) { definition = {}; }\n        var _a, _b, _c;\n        this.definition = tslib_1.__assign(tslib_1.__assign({}, definition), { minLength: (_a = definition.minLength) !== null && _a !== void 0 ? _a : -1, maxLength: (_b = definition.maxLength) !== null && _b !== void 0 ? _b : -1, enumeration: (_c = definition.enumeration) !== null && _c !== void 0 ? _c : [] });\n    }\n    StringType.prototype.getTypes = function () {\n        return ['string'];\n    };\n    StringType.prototype.isValidType = function (value) {\n        return typeof value === 'string';\n    };\n    StringType.prototype.validate = function (value, path) {\n        if (path === void 0) { path = []; }\n        if (!this.isValidType(value)) {\n            throw new schema_1.Violation(\"Expected value of type string at path '\".concat((0, violation_1.formatPath)(path), \"', actual \").concat((0, violation_1.describe)(value), \".\"), path, { type: 'string' });\n        }\n        var _a = this.definition, minLength = _a.minLength, maxLength = _a.maxLength;\n        if (minLength >= 0 && minLength > value.length) {\n            throw new schema_1.Violation(\"Expected \".concat(minLength === maxLength ? 'exactly' : 'at least', \" \")\n                + \"\".concat(minLength, \" \").concat(minLength === 1 ? 'character' : 'characters', \" \")\n                + \"at path '\".concat((0, violation_1.formatPath)(path), \"', actual \").concat(value.length, \".\"), path, { limit: minLength });\n        }\n        if (maxLength >= 0 && maxLength < value.length) {\n            throw new schema_1.Violation(\"Expected \".concat(minLength === maxLength ? 'exactly' : 'at most', \" \")\n                + \"\".concat(maxLength, \" \").concat(maxLength === 1 ? 'character' : 'characters', \" \")\n                + \"at path '\".concat((0, violation_1.formatPath)(path), \"', actual \").concat(value.length, \".\"), path, { limit: maxLength });\n        }\n        var enumeration = this.definition.enumeration;\n        if (enumeration.length > 0 && enumeration.indexOf(value) < 0) {\n            throw new schema_1.Violation(\"Unexpected value at path '\".concat((0, violation_1.formatPath)(path), \"', expecting \")\n                + \"'\".concat(enumeration.length === 1\n                    ? enumeration[0]\n                    : \"\".concat(enumeration.slice(0, -1).join('\\', \\''), \"' or '\").concat(enumeration.slice(-1)), \"', \")\n                + \"found '\".concat(value, \"'.\"), path, { enumeration: enumeration });\n        }\n        var _b = this.definition, format = _b.format, pattern = _b.pattern;\n        if (format !== undefined && !FORMAT[format](value)) {\n            throw new schema_1.Violation(\"Invalid \".concat(format, \" format at path '\").concat((0, violation_1.formatPath)(path), \"'.\"), path, { format: format });\n        }\n        if (pattern !== undefined && !pattern.test(value)) {\n            throw new schema_1.Violation(\"Invalid format at path '\".concat((0, violation_1.formatPath)(path), \"'.\"), path, { pattern: pattern });\n        }\n    };\n    return StringType;\n}());\nexports.StringType = StringType;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}
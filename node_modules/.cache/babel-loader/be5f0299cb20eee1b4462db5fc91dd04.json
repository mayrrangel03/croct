{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TrackerFacade = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar error_1 = require(\"../error\");\n\nvar schema_1 = require(\"../schema\");\n\nvar eventSchemas = {\n  cartViewed: schema_1.cartViewed,\n  cartModified: schema_1.cartModified,\n  checkoutStarted: schema_1.checkoutStarted,\n  orderPlaced: schema_1.orderPlaced,\n  productViewed: schema_1.productViewed,\n  userSignedUp: schema_1.userSignedUp,\n  eventOccurred: schema_1.eventOccurred,\n  interestShown: schema_1.interestShown,\n  postViewed: schema_1.postViewed,\n  goalCompleted: schema_1.goalCompleted,\n  linkOpened: schema_1.linkOpened\n};\n\nfunction createEvent(type, payload) {\n  if (typeof type !== 'string') {\n    throw new Error('The event type must of type string.');\n  }\n\n  if (typeof payload !== 'object' || payload == null) {\n    throw new Error('The event payload must of type object.');\n  }\n\n  var event = tslib_1.__assign({\n    type: type\n  }, payload);\n\n  validateEvent(event);\n  return event;\n}\n\nfunction validateEvent(event) {\n  var type = event.type,\n      payload = tslib_1.__rest(event, [\"type\"]);\n\n  if (!(type in eventSchemas)) {\n    throw new Error(\"Unknown event type '\".concat(type, \"'.\"));\n  }\n\n  try {\n    eventSchemas[type].validate(payload);\n  } catch (violation) {\n    throw new Error(\"Invalid event payload: \".concat((0, error_1.formatCause)(violation)));\n  }\n}\n\nvar TrackerFacade =\n/** @class */\nfunction () {\n  function TrackerFacade(tracker) {\n    this.tracker = tracker;\n  }\n\n  Object.defineProperty(TrackerFacade.prototype, \"flushed\", {\n    get: function () {\n      return this.tracker.flushed;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  TrackerFacade.prototype.enable = function () {\n    this.tracker.enable();\n  };\n\n  TrackerFacade.prototype.disable = function () {\n    this.tracker.disable();\n  };\n\n  TrackerFacade.prototype.addListener = function (listener) {\n    this.tracker.addListener(listener);\n  };\n\n  TrackerFacade.prototype.removeListener = function (listener) {\n    this.tracker.removeListener(listener);\n  };\n\n  TrackerFacade.prototype.track = function (type, payload) {\n    return this.tracker.track(createEvent(type, payload));\n  };\n\n  return TrackerFacade;\n}();\n\nexports.TrackerFacade = TrackerFacade;","map":{"version":3,"names":["Object","defineProperty","exports","value","TrackerFacade","tslib_1","require","error_1","schema_1","eventSchemas","cartViewed","cartModified","checkoutStarted","orderPlaced","productViewed","userSignedUp","eventOccurred","interestShown","postViewed","goalCompleted","linkOpened","createEvent","type","payload","Error","event","__assign","validateEvent","__rest","concat","validate","violation","formatCause","tracker","prototype","get","flushed","enumerable","configurable","enable","disable","addListener","listener","removeListener","track"],"sources":["C:/Users/User/croct/node_modules/@croct/sdk/facade/trackerFacade.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TrackerFacade = void 0;\nvar tslib_1 = require(\"tslib\");\nvar error_1 = require(\"../error\");\nvar schema_1 = require(\"../schema\");\nvar eventSchemas = {\n    cartViewed: schema_1.cartViewed,\n    cartModified: schema_1.cartModified,\n    checkoutStarted: schema_1.checkoutStarted,\n    orderPlaced: schema_1.orderPlaced,\n    productViewed: schema_1.productViewed,\n    userSignedUp: schema_1.userSignedUp,\n    eventOccurred: schema_1.eventOccurred,\n    interestShown: schema_1.interestShown,\n    postViewed: schema_1.postViewed,\n    goalCompleted: schema_1.goalCompleted,\n    linkOpened: schema_1.linkOpened,\n};\nfunction createEvent(type, payload) {\n    if (typeof type !== 'string') {\n        throw new Error('The event type must of type string.');\n    }\n    if (typeof payload !== 'object' || payload == null) {\n        throw new Error('The event payload must of type object.');\n    }\n    var event = tslib_1.__assign({ type: type }, payload);\n    validateEvent(event);\n    return event;\n}\nfunction validateEvent(event) {\n    var type = event.type, payload = tslib_1.__rest(event, [\"type\"]);\n    if (!(type in eventSchemas)) {\n        throw new Error(\"Unknown event type '\".concat(type, \"'.\"));\n    }\n    try {\n        eventSchemas[type].validate(payload);\n    }\n    catch (violation) {\n        throw new Error(\"Invalid event payload: \".concat((0, error_1.formatCause)(violation)));\n    }\n}\nvar TrackerFacade = /** @class */ (function () {\n    function TrackerFacade(tracker) {\n        this.tracker = tracker;\n    }\n    Object.defineProperty(TrackerFacade.prototype, \"flushed\", {\n        get: function () {\n            return this.tracker.flushed;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    TrackerFacade.prototype.enable = function () {\n        this.tracker.enable();\n    };\n    TrackerFacade.prototype.disable = function () {\n        this.tracker.disable();\n    };\n    TrackerFacade.prototype.addListener = function (listener) {\n        this.tracker.addListener(listener);\n    };\n    TrackerFacade.prototype.removeListener = function (listener) {\n        this.tracker.removeListener(listener);\n    };\n    TrackerFacade.prototype.track = function (type, payload) {\n        return this.tracker.track(createEvent(type, payload));\n    };\n    return TrackerFacade;\n}());\nexports.TrackerFacade = TrackerFacade;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}
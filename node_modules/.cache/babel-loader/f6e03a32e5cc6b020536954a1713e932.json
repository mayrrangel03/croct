{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SdkFacade = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar evaluatorFacade_1 = require(\"./evaluatorFacade\");\n\nvar trackerFacade_1 = require(\"./trackerFacade\");\n\nvar userFacade_1 = require(\"./userFacade\");\n\nvar token_1 = require(\"../token\");\n\nvar error_1 = require(\"../error\");\n\nvar schema_1 = require(\"../schema\");\n\nvar sdk_1 = require(\"../sdk\");\n\nvar sessionFacade_1 = require(\"./sessionFacade\");\n\nfunction validateConfiguration(configuration) {\n  if (typeof configuration !== 'object' || configuration === null) {\n    throw new Error('The configuration must be a key-value map.');\n  }\n\n  try {\n    schema_1.sdkFacadeConfigurationSchema.validate(configuration);\n  } catch (violation) {\n    throw new Error(\"Invalid configuration: \".concat((0, error_1.formatCause)(violation)));\n  }\n}\n\nvar SdkFacade =\n/** @class */\nfunction () {\n  function SdkFacade(sdk) {\n    this.sdk = sdk;\n  }\n\n  SdkFacade.init = function (configuration) {\n    var _a, _b, _c;\n\n    validateConfiguration(configuration);\n\n    var _d = configuration.track,\n        track = _d === void 0 ? true : _d,\n        userId = configuration.userId,\n        token = configuration.token,\n        containerConfiguration = tslib_1.__rest(configuration, [\"track\", \"userId\", \"token\"]);\n\n    if (userId !== undefined && token !== undefined) {\n      throw new Error('Either the user ID or token can be specified, but not both.');\n    }\n\n    var sdk = new SdkFacade(sdk_1.Sdk.init(tslib_1.__assign(tslib_1.__assign({}, containerConfiguration), {\n      tokenScope: (_a = containerConfiguration.tokenScope) !== null && _a !== void 0 ? _a : 'global',\n      debug: (_b = containerConfiguration.debug) !== null && _b !== void 0 ? _b : false,\n      test: (_c = containerConfiguration.test) !== null && _c !== void 0 ? _c : false\n    })));\n\n    if (userId !== undefined) {\n      sdk.identify(userId);\n    } else if (token !== undefined) {\n      if (token === null) {\n        sdk.unsetToken();\n      } else {\n        sdk.setToken(token_1.Token.parse(token));\n      }\n    }\n\n    if (track) {\n      sdk.tracker.enable();\n    }\n\n    return sdk;\n  };\n\n  Object.defineProperty(SdkFacade.prototype, \"context\", {\n    get: function () {\n      return this.sdk.context;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(SdkFacade.prototype, \"cidAssigner\", {\n    get: function () {\n      return this.sdk.cidAssigner;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(SdkFacade.prototype, \"tracker\", {\n    get: function () {\n      if (this.trackerFacade === undefined) {\n        this.trackerFacade = new trackerFacade_1.TrackerFacade(this.sdk.tracker);\n      }\n\n      return this.trackerFacade;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(SdkFacade.prototype, \"user\", {\n    get: function () {\n      if (this.userFacade === undefined) {\n        this.userFacade = new userFacade_1.UserFacade(this.context, this.sdk.tracker);\n      }\n\n      return this.userFacade;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(SdkFacade.prototype, \"session\", {\n    get: function () {\n      if (this.sessionFacade === undefined) {\n        this.sessionFacade = new sessionFacade_1.SessionFacade(this.sdk.tracker);\n      }\n\n      return this.sessionFacade;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(SdkFacade.prototype, \"evaluator\", {\n    get: function () {\n      if (this.evaluatorFacade === undefined) {\n        this.evaluatorFacade = new evaluatorFacade_1.EvaluatorFacade(this.sdk.evaluator, new evaluatorFacade_1.TabContextFactory(this.sdk.context.getTab()));\n      }\n\n      return this.evaluatorFacade;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(SdkFacade.prototype, \"eventManager\", {\n    get: function () {\n      var eventManager = this.sdk.eventManager;\n      return {\n        addListener: eventManager.addListener.bind(eventManager),\n        removeListener: eventManager.removeListener.bind(eventManager),\n        dispatch: function (eventName, event) {\n          if (!/[a-z][a-z_]+\\.[a-z][a-z_]+/i.test(eventName)) {\n            throw new Error('The event name must be in the form of \"namespaced.eventName\", where ' + 'both the namespace and event name must start with a letter, followed by ' + 'any series of letters and underscores.');\n          }\n\n          eventManager.dispatch(eventName, event);\n        }\n      };\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  SdkFacade.prototype.identify = function (userId) {\n    this.setToken(token_1.Token.issue(this.sdk.appId, userId));\n  };\n\n  SdkFacade.prototype.anonymize = function () {\n    if (!this.context.isAnonymous()) {\n      this.unsetToken();\n    }\n  };\n\n  SdkFacade.prototype.getToken = function () {\n    return this.context.getToken();\n  };\n\n  SdkFacade.prototype.setToken = function (token) {\n    var _a;\n\n    var currentToken = this.getToken();\n\n    if (currentToken !== null && currentToken.toString() === token.toString()) {\n      return;\n    }\n\n    var currentSubject = (_a = currentToken === null || currentToken === void 0 ? void 0 : currentToken.getSubject()) !== null && _a !== void 0 ? _a : null;\n    var subject = token.getSubject();\n    var logger = this.getLogger();\n\n    if (subject === currentSubject) {\n      this.context.setToken(token);\n      logger.debug('Token refreshed');\n      return;\n    }\n\n    if (currentSubject !== null) {\n      this.trackInternalEvent({\n        type: 'userSignedOut',\n        userId: currentSubject\n      });\n      logger.info('User signed out');\n    }\n\n    this.context.setToken(token);\n\n    if (subject !== null) {\n      this.trackInternalEvent({\n        type: 'userSignedIn',\n        userId: subject\n      });\n      logger.info(\"User signed in as \".concat(subject));\n    }\n\n    logger.debug('New token saved, ');\n  };\n\n  SdkFacade.prototype.unsetToken = function () {\n    var token = this.getToken();\n\n    if (token === null) {\n      return;\n    }\n\n    var logger = this.getLogger();\n    var subject = token.getSubject();\n\n    if (subject !== null) {\n      this.trackInternalEvent({\n        type: 'userSignedOut',\n        userId: subject\n      });\n      logger.info('User signed out');\n    }\n\n    this.context.setToken(null);\n    logger.debug('Token removed');\n  };\n\n  SdkFacade.prototype.trackInternalEvent = function (event) {\n    this.sdk.tracker.track(event).catch(function () {// suppress error as it is already logged by the tracker\n    });\n  };\n\n  SdkFacade.prototype.getLogger = function () {\n    var _a;\n\n    var namespace = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      namespace[_i] = arguments[_i];\n    }\n\n    return (_a = this.sdk).getLogger.apply(_a, tslib_1.__spreadArray([], tslib_1.__read(namespace), false));\n  };\n\n  SdkFacade.prototype.getTabStorage = function (namespace) {\n    var _a;\n\n    var subnamespace = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      subnamespace[_i - 1] = arguments[_i];\n    }\n\n    return (_a = this.sdk).getTabStorage.apply(_a, tslib_1.__spreadArray([namespace], tslib_1.__read(subnamespace), false));\n  };\n\n  SdkFacade.prototype.getBrowserStorage = function (namespace) {\n    var _a;\n\n    var subnamespace = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      subnamespace[_i - 1] = arguments[_i];\n    }\n\n    return (_a = this.sdk).getBrowserStorage.apply(_a, tslib_1.__spreadArray([namespace], tslib_1.__read(subnamespace), false));\n  };\n\n  SdkFacade.prototype.close = function () {\n    return this.sdk.close();\n  };\n\n  return SdkFacade;\n}();\n\nexports.SdkFacade = SdkFacade;","map":{"version":3,"names":["Object","defineProperty","exports","value","SdkFacade","tslib_1","require","evaluatorFacade_1","trackerFacade_1","userFacade_1","token_1","error_1","schema_1","sdk_1","sessionFacade_1","validateConfiguration","configuration","Error","sdkFacadeConfigurationSchema","validate","violation","concat","formatCause","sdk","init","_a","_b","_c","_d","track","userId","token","containerConfiguration","__rest","undefined","Sdk","__assign","tokenScope","debug","test","identify","unsetToken","setToken","Token","parse","tracker","enable","prototype","get","context","enumerable","configurable","cidAssigner","trackerFacade","TrackerFacade","userFacade","UserFacade","sessionFacade","SessionFacade","evaluatorFacade","EvaluatorFacade","evaluator","TabContextFactory","getTab","eventManager","addListener","bind","removeListener","dispatch","eventName","event","issue","appId","anonymize","isAnonymous","getToken","currentToken","toString","currentSubject","getSubject","subject","logger","getLogger","trackInternalEvent","type","info","catch","namespace","_i","arguments","length","apply","__spreadArray","__read","getTabStorage","subnamespace","getBrowserStorage","close"],"sources":["C:/Users/User/croct/node_modules/@croct/sdk/facade/sdkFacade.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SdkFacade = void 0;\nvar tslib_1 = require(\"tslib\");\nvar evaluatorFacade_1 = require(\"./evaluatorFacade\");\nvar trackerFacade_1 = require(\"./trackerFacade\");\nvar userFacade_1 = require(\"./userFacade\");\nvar token_1 = require(\"../token\");\nvar error_1 = require(\"../error\");\nvar schema_1 = require(\"../schema\");\nvar sdk_1 = require(\"../sdk\");\nvar sessionFacade_1 = require(\"./sessionFacade\");\nfunction validateConfiguration(configuration) {\n    if (typeof configuration !== 'object' || configuration === null) {\n        throw new Error('The configuration must be a key-value map.');\n    }\n    try {\n        schema_1.sdkFacadeConfigurationSchema.validate(configuration);\n    }\n    catch (violation) {\n        throw new Error(\"Invalid configuration: \".concat((0, error_1.formatCause)(violation)));\n    }\n}\nvar SdkFacade = /** @class */ (function () {\n    function SdkFacade(sdk) {\n        this.sdk = sdk;\n    }\n    SdkFacade.init = function (configuration) {\n        var _a, _b, _c;\n        validateConfiguration(configuration);\n        var _d = configuration.track, track = _d === void 0 ? true : _d, userId = configuration.userId, token = configuration.token, containerConfiguration = tslib_1.__rest(configuration, [\"track\", \"userId\", \"token\"]);\n        if (userId !== undefined && token !== undefined) {\n            throw new Error('Either the user ID or token can be specified, but not both.');\n        }\n        var sdk = new SdkFacade(sdk_1.Sdk.init(tslib_1.__assign(tslib_1.__assign({}, containerConfiguration), { tokenScope: (_a = containerConfiguration.tokenScope) !== null && _a !== void 0 ? _a : 'global', debug: (_b = containerConfiguration.debug) !== null && _b !== void 0 ? _b : false, test: (_c = containerConfiguration.test) !== null && _c !== void 0 ? _c : false })));\n        if (userId !== undefined) {\n            sdk.identify(userId);\n        }\n        else if (token !== undefined) {\n            if (token === null) {\n                sdk.unsetToken();\n            }\n            else {\n                sdk.setToken(token_1.Token.parse(token));\n            }\n        }\n        if (track) {\n            sdk.tracker.enable();\n        }\n        return sdk;\n    };\n    Object.defineProperty(SdkFacade.prototype, \"context\", {\n        get: function () {\n            return this.sdk.context;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SdkFacade.prototype, \"cidAssigner\", {\n        get: function () {\n            return this.sdk.cidAssigner;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SdkFacade.prototype, \"tracker\", {\n        get: function () {\n            if (this.trackerFacade === undefined) {\n                this.trackerFacade = new trackerFacade_1.TrackerFacade(this.sdk.tracker);\n            }\n            return this.trackerFacade;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SdkFacade.prototype, \"user\", {\n        get: function () {\n            if (this.userFacade === undefined) {\n                this.userFacade = new userFacade_1.UserFacade(this.context, this.sdk.tracker);\n            }\n            return this.userFacade;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SdkFacade.prototype, \"session\", {\n        get: function () {\n            if (this.sessionFacade === undefined) {\n                this.sessionFacade = new sessionFacade_1.SessionFacade(this.sdk.tracker);\n            }\n            return this.sessionFacade;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SdkFacade.prototype, \"evaluator\", {\n        get: function () {\n            if (this.evaluatorFacade === undefined) {\n                this.evaluatorFacade = new evaluatorFacade_1.EvaluatorFacade(this.sdk.evaluator, new evaluatorFacade_1.TabContextFactory(this.sdk.context.getTab()));\n            }\n            return this.evaluatorFacade;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SdkFacade.prototype, \"eventManager\", {\n        get: function () {\n            var eventManager = this.sdk.eventManager;\n            return {\n                addListener: eventManager.addListener.bind(eventManager),\n                removeListener: eventManager.removeListener.bind(eventManager),\n                dispatch: function (eventName, event) {\n                    if (!/[a-z][a-z_]+\\.[a-z][a-z_]+/i.test(eventName)) {\n                        throw new Error('The event name must be in the form of \"namespaced.eventName\", where '\n                            + 'both the namespace and event name must start with a letter, followed by '\n                            + 'any series of letters and underscores.');\n                    }\n                    eventManager.dispatch(eventName, event);\n                },\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SdkFacade.prototype.identify = function (userId) {\n        this.setToken(token_1.Token.issue(this.sdk.appId, userId));\n    };\n    SdkFacade.prototype.anonymize = function () {\n        if (!this.context.isAnonymous()) {\n            this.unsetToken();\n        }\n    };\n    SdkFacade.prototype.getToken = function () {\n        return this.context.getToken();\n    };\n    SdkFacade.prototype.setToken = function (token) {\n        var _a;\n        var currentToken = this.getToken();\n        if (currentToken !== null && currentToken.toString() === token.toString()) {\n            return;\n        }\n        var currentSubject = (_a = currentToken === null || currentToken === void 0 ? void 0 : currentToken.getSubject()) !== null && _a !== void 0 ? _a : null;\n        var subject = token.getSubject();\n        var logger = this.getLogger();\n        if (subject === currentSubject) {\n            this.context.setToken(token);\n            logger.debug('Token refreshed');\n            return;\n        }\n        if (currentSubject !== null) {\n            this.trackInternalEvent({\n                type: 'userSignedOut',\n                userId: currentSubject,\n            });\n            logger.info('User signed out');\n        }\n        this.context.setToken(token);\n        if (subject !== null) {\n            this.trackInternalEvent({\n                type: 'userSignedIn',\n                userId: subject,\n            });\n            logger.info(\"User signed in as \".concat(subject));\n        }\n        logger.debug('New token saved, ');\n    };\n    SdkFacade.prototype.unsetToken = function () {\n        var token = this.getToken();\n        if (token === null) {\n            return;\n        }\n        var logger = this.getLogger();\n        var subject = token.getSubject();\n        if (subject !== null) {\n            this.trackInternalEvent({\n                type: 'userSignedOut',\n                userId: subject,\n            });\n            logger.info('User signed out');\n        }\n        this.context.setToken(null);\n        logger.debug('Token removed');\n    };\n    SdkFacade.prototype.trackInternalEvent = function (event) {\n        this.sdk.tracker.track(event).catch(function () {\n            // suppress error as it is already logged by the tracker\n        });\n    };\n    SdkFacade.prototype.getLogger = function () {\n        var _a;\n        var namespace = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            namespace[_i] = arguments[_i];\n        }\n        return (_a = this.sdk).getLogger.apply(_a, tslib_1.__spreadArray([], tslib_1.__read(namespace), false));\n    };\n    SdkFacade.prototype.getTabStorage = function (namespace) {\n        var _a;\n        var subnamespace = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            subnamespace[_i - 1] = arguments[_i];\n        }\n        return (_a = this.sdk).getTabStorage.apply(_a, tslib_1.__spreadArray([namespace], tslib_1.__read(subnamespace), false));\n    };\n    SdkFacade.prototype.getBrowserStorage = function (namespace) {\n        var _a;\n        var subnamespace = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            subnamespace[_i - 1] = arguments[_i];\n        }\n        return (_a = this.sdk).getBrowserStorage.apply(_a, tslib_1.__spreadArray([namespace], tslib_1.__read(subnamespace), false));\n    };\n    SdkFacade.prototype.close = function () {\n        return this.sdk.close();\n    };\n    return SdkFacade;\n}());\nexports.SdkFacade = SdkFacade;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}
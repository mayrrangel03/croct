{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Container = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar logging_1 = require(\"./logging\");\n\nvar context_1 = require(\"./context\");\n\nvar namespacedStorage_1 = require(\"./namespacedStorage\");\n\nvar retry_1 = require(\"./retry\");\n\nvar queue_1 = require(\"./queue\");\n\nvar tracker_1 = require(\"./tracker\");\n\nvar evaluator_1 = require(\"./evaluator\");\n\nvar transformer_1 = require(\"./transformer\");\n\nvar cid_1 = require(\"./cid\");\n\nvar eventManager_1 = require(\"./eventManager\");\n\nvar cache_1 = require(\"./cache\");\n\nvar guaranteedChannel_1 = require(\"./channel/guaranteedChannel\");\n\nvar channel_1 = require(\"./channel\");\n\nvar Container =\n/** @class */\nfunction () {\n  function Container(configuration) {\n    this.eventManager = new eventManager_1.SynchronousEventManager();\n    this.configuration = configuration;\n  }\n\n  Container.prototype.getConfiguration = function () {\n    return this.configuration;\n  };\n\n  Container.prototype.getEvaluator = function () {\n    if (this.evaluator === undefined) {\n      this.evaluator = this.createEvaluator();\n    }\n\n    return this.evaluator;\n  };\n\n  Container.prototype.createEvaluator = function () {\n    return new evaluator_1.Evaluator({\n      appId: this.configuration.appId,\n      endpointUrl: this.configuration.evaluationEndpointUrl,\n      tokenProvider: this.getTokenProvider(),\n      cidAssigner: this.getCidAssigner()\n    });\n  };\n\n  Container.prototype.getTracker = function () {\n    if (this.tracker === undefined) {\n      this.tracker = this.createTracker();\n    }\n\n    return this.tracker;\n  };\n\n  Container.prototype.createTracker = function () {\n    var context = this.getContext();\n    var tracker = new tracker_1.Tracker({\n      tab: context.getTab(),\n      tokenProvider: this.getTokenProvider(),\n      inactivityRetryPolicy: new retry_1.ArbitraryPolicy([30000, 30000, 120000, 120000, 300000, 300000, 900000]),\n      logger: this.getLogger('Tracker'),\n      channel: this.getBeaconChannel(),\n      eventMetadata: this.configuration.eventMetadata || {}\n    });\n    var queue = this.getBeaconQueue();\n    queue.addCallback('halfEmpty', tracker.unsuspend);\n    queue.addCallback('full', tracker.suspend);\n    return tracker;\n  };\n\n  Container.prototype.getTokenProvider = function () {\n    if (this.tokenProvider === undefined) {\n      var context = this.getContext();\n      this.tokenProvider = {\n        getToken: context.getToken.bind(context)\n      };\n    }\n\n    return this.tokenProvider;\n  };\n\n  Container.prototype.getContext = function () {\n    if (this.context === undefined) {\n      this.context = this.createContext();\n    }\n\n    return this.context;\n  };\n\n  Container.prototype.createContext = function () {\n    var tokenKey = this.resolveStorageNamespace('token');\n    var tabKey = this.resolveStorageNamespace('tab');\n    var browserStorage = this.getLocalStorage();\n    var browserCache = new cache_1.LocalStorageCache(browserStorage, tokenKey);\n    var tabStorage = this.getSessionStorage();\n    this.removeTokenSyncListener = cache_1.LocalStorageCache.autoSync(browserCache);\n    return context_1.Context.load({\n      tokenScope: this.configuration.tokenScope,\n      eventDispatcher: this.getEventManager(),\n      urlSanitizer: this.configuration.urlSanitizer,\n      cache: {\n        tabId: new cache_1.LocalStorageCache(tabStorage, tabKey),\n        tabToken: new cache_1.LocalStorageCache(tabStorage, tokenKey),\n        browserToken: browserCache\n      }\n    });\n  };\n\n  Container.prototype.getBeaconChannel = function () {\n    if (this.beaconChannel === undefined) {\n      this.beaconChannel = this.createBeaconChannel();\n    }\n\n    return this.beaconChannel;\n  };\n\n  Container.prototype.createBeaconChannel = function () {\n    if (this.configuration.test) {\n      return new channel_1.SandboxChannel();\n    }\n\n    var channelLogger = this.getLogger('BeaconChannel');\n    var _a = this.configuration,\n        appId = _a.appId,\n        trackerEndpointUrl = _a.trackerEndpointUrl;\n    var queuedChannel = new channel_1.QueuedChannel(new channel_1.RetryChannel({\n      channel: new channel_1.GuaranteedChannel({\n        channel: new channel_1.BeaconSocketChannel({\n          trackerEndpointUrl: \"\".concat(trackerEndpointUrl, \"/\").concat(appId),\n          tokenParameter: 'token',\n          loggerFactory: this.getLogger.bind(this),\n          logger: channelLogger,\n          channelFactory: function (url, logger) {\n            return new channel_1.SocketChannel({\n              url: url,\n              logger: logger\n            });\n          },\n          cidAssigner: this.getCidAssigner(),\n          cidParameter: 'clientId'\n        }),\n        stamper: new guaranteedChannel_1.TimeStamper(),\n        ackTimeout: 10000,\n        logger: channelLogger\n      }),\n      retryPolicy: new retry_1.BackoffPolicy({\n        minRetryDelay: 1000,\n        maxRetryDelay: 60 * 1000,\n        backoffFactor: 1.5,\n        backoffJitter: 1 // add randomness\n\n      }),\n      logger: channelLogger\n    }), this.getBeaconQueue(), channelLogger);\n    queuedChannel.flush().catch(function () {// Suppress errors as they are already reported by the channel\n    });\n    return new channel_1.EncodedChannel(queuedChannel, transformer_1.encodeJson);\n  };\n\n  Container.prototype.getCidAssigner = function () {\n    if (this.cidAssigner === undefined) {\n      this.cidAssigner = this.createCidAssigner();\n    }\n\n    return this.cidAssigner;\n  };\n\n  Container.prototype.createCidAssigner = function () {\n    if (this.configuration.cid !== undefined) {\n      return new cid_1.FixedAssigner(this.configuration.cid);\n    }\n\n    if (this.configuration.test) {\n      return new cid_1.FixedAssigner('00000000-0000-0000-0000-000000000000');\n    }\n\n    var logger = this.getLogger('CidAssigner');\n    return new cid_1.CachedAssigner(new cid_1.RemoteAssigner(this.configuration.bootstrapEndpointUrl, logger), new cache_1.LocalStorageCache(this.getLocalStorage(), 'croct.cid'), logger);\n  };\n\n  Container.prototype.getBeaconQueue = function () {\n    if (this.beaconQueue === undefined) {\n      this.beaconQueue = this.createBeaconQueue();\n    }\n\n    return this.beaconQueue;\n  };\n\n  Container.prototype.createBeaconQueue = function () {\n    var context = this.getContext();\n    var tab = context.getTab();\n    return new queue_1.MonitoredQueue(new queue_1.CapacityRestrictedQueue(new queue_1.PersistentQueue(this.getGlobalTabStorage('queue'), tab.id), this.configuration.beaconQueueSize), this.getLogger('BeaconQueue'));\n  };\n\n  Container.prototype.getLogger = function () {\n    var namespace = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      namespace[_i] = arguments[_i];\n    }\n\n    var prefix = \"Croct\".concat(namespace.length === 0 ? '' : \":\".concat(namespace.join(':')));\n\n    if (this.configuration.logger !== undefined) {\n      return new logging_1.NamespacedLogger(this.configuration.logger, prefix);\n    }\n\n    if (this.configuration.debug) {\n      return new logging_1.ConsoleLogger(prefix);\n    }\n\n    return new logging_1.NullLogger();\n  };\n\n  Container.prototype.getTabStorage = function (namespace) {\n    var subnamespace = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      subnamespace[_i - 1] = arguments[_i];\n    }\n\n    return this.getGlobalTabStorage.apply(this, tslib_1.__spreadArray(['external', namespace], tslib_1.__read(subnamespace), false));\n  };\n\n  Container.prototype.getBrowserStorage = function (namespace) {\n    var subnamespace = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      subnamespace[_i - 1] = arguments[_i];\n    }\n\n    return this.getGlobalBrowserStorage.apply(this, tslib_1.__spreadArray(['external', namespace], tslib_1.__read(subnamespace), false));\n  };\n\n  Container.prototype.getGlobalTabStorage = function (namespace) {\n    var subnamespace = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      subnamespace[_i - 1] = arguments[_i];\n    }\n\n    return new namespacedStorage_1.NamespacedStorage(this.getSessionStorage(), this.resolveStorageNamespace.apply(this, tslib_1.__spreadArray([namespace], tslib_1.__read(subnamespace), false)));\n  };\n\n  Container.prototype.getGlobalBrowserStorage = function (namespace) {\n    var subnamespace = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      subnamespace[_i - 1] = arguments[_i];\n    }\n\n    return new namespacedStorage_1.NamespacedStorage(this.getLocalStorage(), this.resolveStorageNamespace.apply(this, tslib_1.__spreadArray([namespace], tslib_1.__read(subnamespace), false)));\n  };\n\n  Container.prototype.resolveStorageNamespace = function (namespace) {\n    var subnamespace = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      subnamespace[_i - 1] = arguments[_i];\n    }\n\n    return \"croct[\".concat(this.configuration.appId.toLowerCase(), \"].\").concat([namespace].concat(subnamespace).join('.'));\n  };\n\n  Container.prototype.getLocalStorage = function () {\n    return localStorage;\n  };\n\n  Container.prototype.getSessionStorage = function () {\n    return sessionStorage;\n  };\n\n  Container.prototype.getEventManager = function () {\n    return this.eventManager;\n  };\n\n  Container.prototype.dispose = function () {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var logger;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            logger = this.getLogger();\n            if (!this.beaconChannel) return [3\n            /*break*/\n            , 2];\n            logger.debug('Closing beacon channel...');\n            return [4\n            /*yield*/\n            , this.beaconChannel.close()];\n\n          case 1:\n            _a.sent();\n\n            _a.label = 2;\n\n          case 2:\n            if (this.removeTokenSyncListener) {\n              logger.debug('Removing token sync listener...');\n              this.removeTokenSyncListener();\n            }\n\n            if (!this.tracker) return [3\n            /*break*/\n            , 4];\n\n            if (this.beaconQueue) {\n              logger.debug('Removing queue listeners...');\n              this.beaconQueue.removeCallback('halfEmpty', this.tracker.unsuspend);\n              this.beaconQueue.removeCallback('full', this.tracker.suspend);\n            }\n\n            logger.debug('Suspending tracker...');\n            this.tracker.suspend();\n            return [4\n            /*yield*/\n            , this.tracker.flushed];\n\n          case 3:\n            _a.sent();\n\n            _a.label = 4;\n\n          case 4:\n            delete this.context;\n            delete this.tokenProvider;\n            delete this.cidAssigner;\n            delete this.tracker;\n            delete this.evaluator;\n            delete this.beaconChannel;\n            delete this.beaconQueue;\n            delete this.removeTokenSyncListener;\n            logger.debug('Container resources released.');\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  return Container;\n}();\n\nexports.Container = Container;","map":{"version":3,"names":["Object","defineProperty","exports","value","Container","tslib_1","require","logging_1","context_1","namespacedStorage_1","retry_1","queue_1","tracker_1","evaluator_1","transformer_1","cid_1","eventManager_1","cache_1","guaranteedChannel_1","channel_1","configuration","eventManager","SynchronousEventManager","prototype","getConfiguration","getEvaluator","evaluator","undefined","createEvaluator","Evaluator","appId","endpointUrl","evaluationEndpointUrl","tokenProvider","getTokenProvider","cidAssigner","getCidAssigner","getTracker","tracker","createTracker","context","getContext","Tracker","tab","getTab","inactivityRetryPolicy","ArbitraryPolicy","logger","getLogger","channel","getBeaconChannel","eventMetadata","queue","getBeaconQueue","addCallback","unsuspend","suspend","getToken","bind","createContext","tokenKey","resolveStorageNamespace","tabKey","browserStorage","getLocalStorage","browserCache","LocalStorageCache","tabStorage","getSessionStorage","removeTokenSyncListener","autoSync","Context","load","tokenScope","eventDispatcher","getEventManager","urlSanitizer","cache","tabId","tabToken","browserToken","beaconChannel","createBeaconChannel","test","SandboxChannel","channelLogger","_a","trackerEndpointUrl","queuedChannel","QueuedChannel","RetryChannel","GuaranteedChannel","BeaconSocketChannel","concat","tokenParameter","loggerFactory","channelFactory","url","SocketChannel","cidParameter","stamper","TimeStamper","ackTimeout","retryPolicy","BackoffPolicy","minRetryDelay","maxRetryDelay","backoffFactor","backoffJitter","flush","catch","EncodedChannel","encodeJson","createCidAssigner","cid","FixedAssigner","CachedAssigner","RemoteAssigner","bootstrapEndpointUrl","beaconQueue","createBeaconQueue","MonitoredQueue","CapacityRestrictedQueue","PersistentQueue","getGlobalTabStorage","id","beaconQueueSize","namespace","_i","arguments","length","prefix","join","NamespacedLogger","debug","ConsoleLogger","NullLogger","getTabStorage","subnamespace","apply","__spreadArray","__read","getBrowserStorage","getGlobalBrowserStorage","NamespacedStorage","toLowerCase","localStorage","sessionStorage","dispose","__awaiter","__generator","label","close","sent","removeCallback","flushed"],"sources":["C:/Users/User/croct/node_modules/@croct/sdk/container.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Container = void 0;\nvar tslib_1 = require(\"tslib\");\nvar logging_1 = require(\"./logging\");\nvar context_1 = require(\"./context\");\nvar namespacedStorage_1 = require(\"./namespacedStorage\");\nvar retry_1 = require(\"./retry\");\nvar queue_1 = require(\"./queue\");\nvar tracker_1 = require(\"./tracker\");\nvar evaluator_1 = require(\"./evaluator\");\nvar transformer_1 = require(\"./transformer\");\nvar cid_1 = require(\"./cid\");\nvar eventManager_1 = require(\"./eventManager\");\nvar cache_1 = require(\"./cache\");\nvar guaranteedChannel_1 = require(\"./channel/guaranteedChannel\");\nvar channel_1 = require(\"./channel\");\nvar Container = /** @class */ (function () {\n    function Container(configuration) {\n        this.eventManager = new eventManager_1.SynchronousEventManager();\n        this.configuration = configuration;\n    }\n    Container.prototype.getConfiguration = function () {\n        return this.configuration;\n    };\n    Container.prototype.getEvaluator = function () {\n        if (this.evaluator === undefined) {\n            this.evaluator = this.createEvaluator();\n        }\n        return this.evaluator;\n    };\n    Container.prototype.createEvaluator = function () {\n        return new evaluator_1.Evaluator({\n            appId: this.configuration.appId,\n            endpointUrl: this.configuration.evaluationEndpointUrl,\n            tokenProvider: this.getTokenProvider(),\n            cidAssigner: this.getCidAssigner(),\n        });\n    };\n    Container.prototype.getTracker = function () {\n        if (this.tracker === undefined) {\n            this.tracker = this.createTracker();\n        }\n        return this.tracker;\n    };\n    Container.prototype.createTracker = function () {\n        var context = this.getContext();\n        var tracker = new tracker_1.Tracker({\n            tab: context.getTab(),\n            tokenProvider: this.getTokenProvider(),\n            inactivityRetryPolicy: new retry_1.ArbitraryPolicy([30000, 30000, 120000, 120000, 300000, 300000, 900000]),\n            logger: this.getLogger('Tracker'),\n            channel: this.getBeaconChannel(),\n            eventMetadata: this.configuration.eventMetadata || {},\n        });\n        var queue = this.getBeaconQueue();\n        queue.addCallback('halfEmpty', tracker.unsuspend);\n        queue.addCallback('full', tracker.suspend);\n        return tracker;\n    };\n    Container.prototype.getTokenProvider = function () {\n        if (this.tokenProvider === undefined) {\n            var context = this.getContext();\n            this.tokenProvider = { getToken: context.getToken.bind(context) };\n        }\n        return this.tokenProvider;\n    };\n    Container.prototype.getContext = function () {\n        if (this.context === undefined) {\n            this.context = this.createContext();\n        }\n        return this.context;\n    };\n    Container.prototype.createContext = function () {\n        var tokenKey = this.resolveStorageNamespace('token');\n        var tabKey = this.resolveStorageNamespace('tab');\n        var browserStorage = this.getLocalStorage();\n        var browserCache = new cache_1.LocalStorageCache(browserStorage, tokenKey);\n        var tabStorage = this.getSessionStorage();\n        this.removeTokenSyncListener = cache_1.LocalStorageCache.autoSync(browserCache);\n        return context_1.Context.load({\n            tokenScope: this.configuration.tokenScope,\n            eventDispatcher: this.getEventManager(),\n            urlSanitizer: this.configuration.urlSanitizer,\n            cache: {\n                tabId: new cache_1.LocalStorageCache(tabStorage, tabKey),\n                tabToken: new cache_1.LocalStorageCache(tabStorage, tokenKey),\n                browserToken: browserCache,\n            },\n        });\n    };\n    Container.prototype.getBeaconChannel = function () {\n        if (this.beaconChannel === undefined) {\n            this.beaconChannel = this.createBeaconChannel();\n        }\n        return this.beaconChannel;\n    };\n    Container.prototype.createBeaconChannel = function () {\n        if (this.configuration.test) {\n            return new channel_1.SandboxChannel();\n        }\n        var channelLogger = this.getLogger('BeaconChannel');\n        var _a = this.configuration, appId = _a.appId, trackerEndpointUrl = _a.trackerEndpointUrl;\n        var queuedChannel = new channel_1.QueuedChannel(new channel_1.RetryChannel({\n            channel: new channel_1.GuaranteedChannel({\n                channel: new channel_1.BeaconSocketChannel({\n                    trackerEndpointUrl: \"\".concat(trackerEndpointUrl, \"/\").concat(appId),\n                    tokenParameter: 'token',\n                    loggerFactory: this.getLogger.bind(this),\n                    logger: channelLogger,\n                    channelFactory: function (url, logger) { return new channel_1.SocketChannel({ url: url, logger: logger }); },\n                    cidAssigner: this.getCidAssigner(),\n                    cidParameter: 'clientId',\n                }),\n                stamper: new guaranteedChannel_1.TimeStamper(),\n                ackTimeout: 10000,\n                logger: channelLogger,\n            }),\n            retryPolicy: new retry_1.BackoffPolicy({\n                minRetryDelay: 1000,\n                maxRetryDelay: 60 * 1000,\n                backoffFactor: 1.5,\n                backoffJitter: 1, // add randomness\n            }),\n            logger: channelLogger,\n        }), this.getBeaconQueue(), channelLogger);\n        queuedChannel.flush().catch(function () {\n            // Suppress errors as they are already reported by the channel\n        });\n        return new channel_1.EncodedChannel(queuedChannel, transformer_1.encodeJson);\n    };\n    Container.prototype.getCidAssigner = function () {\n        if (this.cidAssigner === undefined) {\n            this.cidAssigner = this.createCidAssigner();\n        }\n        return this.cidAssigner;\n    };\n    Container.prototype.createCidAssigner = function () {\n        if (this.configuration.cid !== undefined) {\n            return new cid_1.FixedAssigner(this.configuration.cid);\n        }\n        if (this.configuration.test) {\n            return new cid_1.FixedAssigner('00000000-0000-0000-0000-000000000000');\n        }\n        var logger = this.getLogger('CidAssigner');\n        return new cid_1.CachedAssigner(new cid_1.RemoteAssigner(this.configuration.bootstrapEndpointUrl, logger), new cache_1.LocalStorageCache(this.getLocalStorage(), 'croct.cid'), logger);\n    };\n    Container.prototype.getBeaconQueue = function () {\n        if (this.beaconQueue === undefined) {\n            this.beaconQueue = this.createBeaconQueue();\n        }\n        return this.beaconQueue;\n    };\n    Container.prototype.createBeaconQueue = function () {\n        var context = this.getContext();\n        var tab = context.getTab();\n        return new queue_1.MonitoredQueue(new queue_1.CapacityRestrictedQueue(new queue_1.PersistentQueue(this.getGlobalTabStorage('queue'), tab.id), this.configuration.beaconQueueSize), this.getLogger('BeaconQueue'));\n    };\n    Container.prototype.getLogger = function () {\n        var namespace = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            namespace[_i] = arguments[_i];\n        }\n        var prefix = \"Croct\".concat(namespace.length === 0 ? '' : \":\".concat(namespace.join(':')));\n        if (this.configuration.logger !== undefined) {\n            return new logging_1.NamespacedLogger(this.configuration.logger, prefix);\n        }\n        if (this.configuration.debug) {\n            return new logging_1.ConsoleLogger(prefix);\n        }\n        return new logging_1.NullLogger();\n    };\n    Container.prototype.getTabStorage = function (namespace) {\n        var subnamespace = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            subnamespace[_i - 1] = arguments[_i];\n        }\n        return this.getGlobalTabStorage.apply(this, tslib_1.__spreadArray(['external', namespace], tslib_1.__read(subnamespace), false));\n    };\n    Container.prototype.getBrowserStorage = function (namespace) {\n        var subnamespace = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            subnamespace[_i - 1] = arguments[_i];\n        }\n        return this.getGlobalBrowserStorage.apply(this, tslib_1.__spreadArray(['external', namespace], tslib_1.__read(subnamespace), false));\n    };\n    Container.prototype.getGlobalTabStorage = function (namespace) {\n        var subnamespace = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            subnamespace[_i - 1] = arguments[_i];\n        }\n        return new namespacedStorage_1.NamespacedStorage(this.getSessionStorage(), this.resolveStorageNamespace.apply(this, tslib_1.__spreadArray([namespace], tslib_1.__read(subnamespace), false)));\n    };\n    Container.prototype.getGlobalBrowserStorage = function (namespace) {\n        var subnamespace = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            subnamespace[_i - 1] = arguments[_i];\n        }\n        return new namespacedStorage_1.NamespacedStorage(this.getLocalStorage(), this.resolveStorageNamespace.apply(this, tslib_1.__spreadArray([namespace], tslib_1.__read(subnamespace), false)));\n    };\n    Container.prototype.resolveStorageNamespace = function (namespace) {\n        var subnamespace = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            subnamespace[_i - 1] = arguments[_i];\n        }\n        return \"croct[\".concat(this.configuration.appId.toLowerCase(), \"].\").concat([namespace].concat(subnamespace).join('.'));\n    };\n    Container.prototype.getLocalStorage = function () {\n        return localStorage;\n    };\n    Container.prototype.getSessionStorage = function () {\n        return sessionStorage;\n    };\n    Container.prototype.getEventManager = function () {\n        return this.eventManager;\n    };\n    Container.prototype.dispose = function () {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var logger;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        logger = this.getLogger();\n                        if (!this.beaconChannel) return [3 /*break*/, 2];\n                        logger.debug('Closing beacon channel...');\n                        return [4 /*yield*/, this.beaconChannel.close()];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2:\n                        if (this.removeTokenSyncListener) {\n                            logger.debug('Removing token sync listener...');\n                            this.removeTokenSyncListener();\n                        }\n                        if (!this.tracker) return [3 /*break*/, 4];\n                        if (this.beaconQueue) {\n                            logger.debug('Removing queue listeners...');\n                            this.beaconQueue.removeCallback('halfEmpty', this.tracker.unsuspend);\n                            this.beaconQueue.removeCallback('full', this.tracker.suspend);\n                        }\n                        logger.debug('Suspending tracker...');\n                        this.tracker.suspend();\n                        return [4 /*yield*/, this.tracker.flushed];\n                    case 3:\n                        _a.sent();\n                        _a.label = 4;\n                    case 4:\n                        delete this.context;\n                        delete this.tokenProvider;\n                        delete this.cidAssigner;\n                        delete this.tracker;\n                        delete this.evaluator;\n                        delete this.beaconChannel;\n                        delete this.beaconQueue;\n                        delete this.removeTokenSyncListener;\n                        logger.debug('Container resources released.');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return Container;\n}());\nexports.Container = Container;\n"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;EAAEC,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,SAAR,GAAoB,KAAK,CAAzB;;AACA,IAAIC,OAAO,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,IAAIC,SAAS,GAAGD,OAAO,CAAC,WAAD,CAAvB;;AACA,IAAIE,SAAS,GAAGF,OAAO,CAAC,WAAD,CAAvB;;AACA,IAAIG,mBAAmB,GAAGH,OAAO,CAAC,qBAAD,CAAjC;;AACA,IAAII,OAAO,GAAGJ,OAAO,CAAC,SAAD,CAArB;;AACA,IAAIK,OAAO,GAAGL,OAAO,CAAC,SAAD,CAArB;;AACA,IAAIM,SAAS,GAAGN,OAAO,CAAC,WAAD,CAAvB;;AACA,IAAIO,WAAW,GAAGP,OAAO,CAAC,aAAD,CAAzB;;AACA,IAAIQ,aAAa,GAAGR,OAAO,CAAC,eAAD,CAA3B;;AACA,IAAIS,KAAK,GAAGT,OAAO,CAAC,OAAD,CAAnB;;AACA,IAAIU,cAAc,GAAGV,OAAO,CAAC,gBAAD,CAA5B;;AACA,IAAIW,OAAO,GAAGX,OAAO,CAAC,SAAD,CAArB;;AACA,IAAIY,mBAAmB,GAAGZ,OAAO,CAAC,6BAAD,CAAjC;;AACA,IAAIa,SAAS,GAAGb,OAAO,CAAC,WAAD,CAAvB;;AACA,IAAIF,SAAS;AAAG;AAAe,YAAY;EACvC,SAASA,SAAT,CAAmBgB,aAAnB,EAAkC;IAC9B,KAAKC,YAAL,GAAoB,IAAIL,cAAc,CAACM,uBAAnB,EAApB;IACA,KAAKF,aAAL,GAAqBA,aAArB;EACH;;EACDhB,SAAS,CAACmB,SAAV,CAAoBC,gBAApB,GAAuC,YAAY;IAC/C,OAAO,KAAKJ,aAAZ;EACH,CAFD;;EAGAhB,SAAS,CAACmB,SAAV,CAAoBE,YAApB,GAAmC,YAAY;IAC3C,IAAI,KAAKC,SAAL,KAAmBC,SAAvB,EAAkC;MAC9B,KAAKD,SAAL,GAAiB,KAAKE,eAAL,EAAjB;IACH;;IACD,OAAO,KAAKF,SAAZ;EACH,CALD;;EAMAtB,SAAS,CAACmB,SAAV,CAAoBK,eAApB,GAAsC,YAAY;IAC9C,OAAO,IAAIf,WAAW,CAACgB,SAAhB,CAA0B;MAC7BC,KAAK,EAAE,KAAKV,aAAL,CAAmBU,KADG;MAE7BC,WAAW,EAAE,KAAKX,aAAL,CAAmBY,qBAFH;MAG7BC,aAAa,EAAE,KAAKC,gBAAL,EAHc;MAI7BC,WAAW,EAAE,KAAKC,cAAL;IAJgB,CAA1B,CAAP;EAMH,CAPD;;EAQAhC,SAAS,CAACmB,SAAV,CAAoBc,UAApB,GAAiC,YAAY;IACzC,IAAI,KAAKC,OAAL,KAAiBX,SAArB,EAAgC;MAC5B,KAAKW,OAAL,GAAe,KAAKC,aAAL,EAAf;IACH;;IACD,OAAO,KAAKD,OAAZ;EACH,CALD;;EAMAlC,SAAS,CAACmB,SAAV,CAAoBgB,aAApB,GAAoC,YAAY;IAC5C,IAAIC,OAAO,GAAG,KAAKC,UAAL,EAAd;IACA,IAAIH,OAAO,GAAG,IAAI1B,SAAS,CAAC8B,OAAd,CAAsB;MAChCC,GAAG,EAAEH,OAAO,CAACI,MAAR,EAD2B;MAEhCX,aAAa,EAAE,KAAKC,gBAAL,EAFiB;MAGhCW,qBAAqB,EAAE,IAAInC,OAAO,CAACoC,eAAZ,CAA4B,CAAC,KAAD,EAAQ,KAAR,EAAe,MAAf,EAAuB,MAAvB,EAA+B,MAA/B,EAAuC,MAAvC,EAA+C,MAA/C,CAA5B,CAHS;MAIhCC,MAAM,EAAE,KAAKC,SAAL,CAAe,SAAf,CAJwB;MAKhCC,OAAO,EAAE,KAAKC,gBAAL,EALuB;MAMhCC,aAAa,EAAE,KAAK/B,aAAL,CAAmB+B,aAAnB,IAAoC;IANnB,CAAtB,CAAd;IAQA,IAAIC,KAAK,GAAG,KAAKC,cAAL,EAAZ;IACAD,KAAK,CAACE,WAAN,CAAkB,WAAlB,EAA+BhB,OAAO,CAACiB,SAAvC;IACAH,KAAK,CAACE,WAAN,CAAkB,MAAlB,EAA0BhB,OAAO,CAACkB,OAAlC;IACA,OAAOlB,OAAP;EACH,CAdD;;EAeAlC,SAAS,CAACmB,SAAV,CAAoBW,gBAApB,GAAuC,YAAY;IAC/C,IAAI,KAAKD,aAAL,KAAuBN,SAA3B,EAAsC;MAClC,IAAIa,OAAO,GAAG,KAAKC,UAAL,EAAd;MACA,KAAKR,aAAL,GAAqB;QAAEwB,QAAQ,EAAEjB,OAAO,CAACiB,QAAR,CAAiBC,IAAjB,CAAsBlB,OAAtB;MAAZ,CAArB;IACH;;IACD,OAAO,KAAKP,aAAZ;EACH,CAND;;EAOA7B,SAAS,CAACmB,SAAV,CAAoBkB,UAApB,GAAiC,YAAY;IACzC,IAAI,KAAKD,OAAL,KAAiBb,SAArB,EAAgC;MAC5B,KAAKa,OAAL,GAAe,KAAKmB,aAAL,EAAf;IACH;;IACD,OAAO,KAAKnB,OAAZ;EACH,CALD;;EAMApC,SAAS,CAACmB,SAAV,CAAoBoC,aAApB,GAAoC,YAAY;IAC5C,IAAIC,QAAQ,GAAG,KAAKC,uBAAL,CAA6B,OAA7B,CAAf;IACA,IAAIC,MAAM,GAAG,KAAKD,uBAAL,CAA6B,KAA7B,CAAb;IACA,IAAIE,cAAc,GAAG,KAAKC,eAAL,EAArB;IACA,IAAIC,YAAY,GAAG,IAAIhD,OAAO,CAACiD,iBAAZ,CAA8BH,cAA9B,EAA8CH,QAA9C,CAAnB;IACA,IAAIO,UAAU,GAAG,KAAKC,iBAAL,EAAjB;IACA,KAAKC,uBAAL,GAA+BpD,OAAO,CAACiD,iBAAR,CAA0BI,QAA1B,CAAmCL,YAAnC,CAA/B;IACA,OAAOzD,SAAS,CAAC+D,OAAV,CAAkBC,IAAlB,CAAuB;MAC1BC,UAAU,EAAE,KAAKrD,aAAL,CAAmBqD,UADL;MAE1BC,eAAe,EAAE,KAAKC,eAAL,EAFS;MAG1BC,YAAY,EAAE,KAAKxD,aAAL,CAAmBwD,YAHP;MAI1BC,KAAK,EAAE;QACHC,KAAK,EAAE,IAAI7D,OAAO,CAACiD,iBAAZ,CAA8BC,UAA9B,EAA0CL,MAA1C,CADJ;QAEHiB,QAAQ,EAAE,IAAI9D,OAAO,CAACiD,iBAAZ,CAA8BC,UAA9B,EAA0CP,QAA1C,CAFP;QAGHoB,YAAY,EAAEf;MAHX;IAJmB,CAAvB,CAAP;EAUH,CAjBD;;EAkBA7D,SAAS,CAACmB,SAAV,CAAoB2B,gBAApB,GAAuC,YAAY;IAC/C,IAAI,KAAK+B,aAAL,KAAuBtD,SAA3B,EAAsC;MAClC,KAAKsD,aAAL,GAAqB,KAAKC,mBAAL,EAArB;IACH;;IACD,OAAO,KAAKD,aAAZ;EACH,CALD;;EAMA7E,SAAS,CAACmB,SAAV,CAAoB2D,mBAApB,GAA0C,YAAY;IAClD,IAAI,KAAK9D,aAAL,CAAmB+D,IAAvB,EAA6B;MACzB,OAAO,IAAIhE,SAAS,CAACiE,cAAd,EAAP;IACH;;IACD,IAAIC,aAAa,GAAG,KAAKrC,SAAL,CAAe,eAAf,CAApB;IACA,IAAIsC,EAAE,GAAG,KAAKlE,aAAd;IAAA,IAA6BU,KAAK,GAAGwD,EAAE,CAACxD,KAAxC;IAAA,IAA+CyD,kBAAkB,GAAGD,EAAE,CAACC,kBAAvE;IACA,IAAIC,aAAa,GAAG,IAAIrE,SAAS,CAACsE,aAAd,CAA4B,IAAItE,SAAS,CAACuE,YAAd,CAA2B;MACvEzC,OAAO,EAAE,IAAI9B,SAAS,CAACwE,iBAAd,CAAgC;QACrC1C,OAAO,EAAE,IAAI9B,SAAS,CAACyE,mBAAd,CAAkC;UACvCL,kBAAkB,EAAE,GAAGM,MAAH,CAAUN,kBAAV,EAA8B,GAA9B,EAAmCM,MAAnC,CAA0C/D,KAA1C,CADmB;UAEvCgE,cAAc,EAAE,OAFuB;UAGvCC,aAAa,EAAE,KAAK/C,SAAL,CAAeU,IAAf,CAAoB,IAApB,CAHwB;UAIvCX,MAAM,EAAEsC,aAJ+B;UAKvCW,cAAc,EAAE,UAAUC,GAAV,EAAelD,MAAf,EAAuB;YAAE,OAAO,IAAI5B,SAAS,CAAC+E,aAAd,CAA4B;cAAED,GAAG,EAAEA,GAAP;cAAYlD,MAAM,EAAEA;YAApB,CAA5B,CAAP;UAAmE,CALrE;UAMvCZ,WAAW,EAAE,KAAKC,cAAL,EAN0B;UAOvC+D,YAAY,EAAE;QAPyB,CAAlC,CAD4B;QAUrCC,OAAO,EAAE,IAAIlF,mBAAmB,CAACmF,WAAxB,EAV4B;QAWrCC,UAAU,EAAE,KAXyB;QAYrCvD,MAAM,EAAEsC;MAZ6B,CAAhC,CAD8D;MAevEkB,WAAW,EAAE,IAAI7F,OAAO,CAAC8F,aAAZ,CAA0B;QACnCC,aAAa,EAAE,IADoB;QAEnCC,aAAa,EAAE,KAAK,IAFe;QAGnCC,aAAa,EAAE,GAHoB;QAInCC,aAAa,EAAE,CAJoB,CAIjB;;MAJiB,CAA1B,CAf0D;MAqBvE7D,MAAM,EAAEsC;IArB+D,CAA3B,CAA5B,EAsBhB,KAAKhC,cAAL,EAtBgB,EAsBOgC,aAtBP,CAApB;IAuBAG,aAAa,CAACqB,KAAd,GAAsBC,KAAtB,CAA4B,YAAY,CACpC;IACH,CAFD;IAGA,OAAO,IAAI3F,SAAS,CAAC4F,cAAd,CAA6BvB,aAA7B,EAA4C1E,aAAa,CAACkG,UAA1D,CAAP;EACH,CAjCD;;EAkCA5G,SAAS,CAACmB,SAAV,CAAoBa,cAApB,GAAqC,YAAY;IAC7C,IAAI,KAAKD,WAAL,KAAqBR,SAAzB,EAAoC;MAChC,KAAKQ,WAAL,GAAmB,KAAK8E,iBAAL,EAAnB;IACH;;IACD,OAAO,KAAK9E,WAAZ;EACH,CALD;;EAMA/B,SAAS,CAACmB,SAAV,CAAoB0F,iBAApB,GAAwC,YAAY;IAChD,IAAI,KAAK7F,aAAL,CAAmB8F,GAAnB,KAA2BvF,SAA/B,EAA0C;MACtC,OAAO,IAAIZ,KAAK,CAACoG,aAAV,CAAwB,KAAK/F,aAAL,CAAmB8F,GAA3C,CAAP;IACH;;IACD,IAAI,KAAK9F,aAAL,CAAmB+D,IAAvB,EAA6B;MACzB,OAAO,IAAIpE,KAAK,CAACoG,aAAV,CAAwB,sCAAxB,CAAP;IACH;;IACD,IAAIpE,MAAM,GAAG,KAAKC,SAAL,CAAe,aAAf,CAAb;IACA,OAAO,IAAIjC,KAAK,CAACqG,cAAV,CAAyB,IAAIrG,KAAK,CAACsG,cAAV,CAAyB,KAAKjG,aAAL,CAAmBkG,oBAA5C,EAAkEvE,MAAlE,CAAzB,EAAoG,IAAI9B,OAAO,CAACiD,iBAAZ,CAA8B,KAAKF,eAAL,EAA9B,EAAsD,WAAtD,CAApG,EAAwKjB,MAAxK,CAAP;EACH,CATD;;EAUA3C,SAAS,CAACmB,SAAV,CAAoB8B,cAApB,GAAqC,YAAY;IAC7C,IAAI,KAAKkE,WAAL,KAAqB5F,SAAzB,EAAoC;MAChC,KAAK4F,WAAL,GAAmB,KAAKC,iBAAL,EAAnB;IACH;;IACD,OAAO,KAAKD,WAAZ;EACH,CALD;;EAMAnH,SAAS,CAACmB,SAAV,CAAoBiG,iBAApB,GAAwC,YAAY;IAChD,IAAIhF,OAAO,GAAG,KAAKC,UAAL,EAAd;IACA,IAAIE,GAAG,GAAGH,OAAO,CAACI,MAAR,EAAV;IACA,OAAO,IAAIjC,OAAO,CAAC8G,cAAZ,CAA2B,IAAI9G,OAAO,CAAC+G,uBAAZ,CAAoC,IAAI/G,OAAO,CAACgH,eAAZ,CAA4B,KAAKC,mBAAL,CAAyB,OAAzB,CAA5B,EAA+DjF,GAAG,CAACkF,EAAnE,CAApC,EAA4G,KAAKzG,aAAL,CAAmB0G,eAA/H,CAA3B,EAA4K,KAAK9E,SAAL,CAAe,aAAf,CAA5K,CAAP;EACH,CAJD;;EAKA5C,SAAS,CAACmB,SAAV,CAAoByB,SAApB,GAAgC,YAAY;IACxC,IAAI+E,SAAS,GAAG,EAAhB;;IACA,KAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACC,MAAhC,EAAwCF,EAAE,EAA1C,EAA8C;MAC1CD,SAAS,CAACC,EAAD,CAAT,GAAgBC,SAAS,CAACD,EAAD,CAAzB;IACH;;IACD,IAAIG,MAAM,GAAG,QAAQtC,MAAR,CAAekC,SAAS,CAACG,MAAV,KAAqB,CAArB,GAAyB,EAAzB,GAA8B,IAAIrC,MAAJ,CAAWkC,SAAS,CAACK,IAAV,CAAe,GAAf,CAAX,CAA7C,CAAb;;IACA,IAAI,KAAKhH,aAAL,CAAmB2B,MAAnB,KAA8BpB,SAAlC,EAA6C;MACzC,OAAO,IAAIpB,SAAS,CAAC8H,gBAAd,CAA+B,KAAKjH,aAAL,CAAmB2B,MAAlD,EAA0DoF,MAA1D,CAAP;IACH;;IACD,IAAI,KAAK/G,aAAL,CAAmBkH,KAAvB,EAA8B;MAC1B,OAAO,IAAI/H,SAAS,CAACgI,aAAd,CAA4BJ,MAA5B,CAAP;IACH;;IACD,OAAO,IAAI5H,SAAS,CAACiI,UAAd,EAAP;EACH,CAbD;;EAcApI,SAAS,CAACmB,SAAV,CAAoBkH,aAApB,GAAoC,UAAUV,SAAV,EAAqB;IACrD,IAAIW,YAAY,GAAG,EAAnB;;IACA,KAAK,IAAIV,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACC,MAAhC,EAAwCF,EAAE,EAA1C,EAA8C;MAC1CU,YAAY,CAACV,EAAE,GAAG,CAAN,CAAZ,GAAuBC,SAAS,CAACD,EAAD,CAAhC;IACH;;IACD,OAAO,KAAKJ,mBAAL,CAAyBe,KAAzB,CAA+B,IAA/B,EAAqCtI,OAAO,CAACuI,aAAR,CAAsB,CAAC,UAAD,EAAab,SAAb,CAAtB,EAA+C1H,OAAO,CAACwI,MAAR,CAAeH,YAAf,CAA/C,EAA6E,KAA7E,CAArC,CAAP;EACH,CAND;;EAOAtI,SAAS,CAACmB,SAAV,CAAoBuH,iBAApB,GAAwC,UAAUf,SAAV,EAAqB;IACzD,IAAIW,YAAY,GAAG,EAAnB;;IACA,KAAK,IAAIV,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACC,MAAhC,EAAwCF,EAAE,EAA1C,EAA8C;MAC1CU,YAAY,CAACV,EAAE,GAAG,CAAN,CAAZ,GAAuBC,SAAS,CAACD,EAAD,CAAhC;IACH;;IACD,OAAO,KAAKe,uBAAL,CAA6BJ,KAA7B,CAAmC,IAAnC,EAAyCtI,OAAO,CAACuI,aAAR,CAAsB,CAAC,UAAD,EAAab,SAAb,CAAtB,EAA+C1H,OAAO,CAACwI,MAAR,CAAeH,YAAf,CAA/C,EAA6E,KAA7E,CAAzC,CAAP;EACH,CAND;;EAOAtI,SAAS,CAACmB,SAAV,CAAoBqG,mBAApB,GAA0C,UAAUG,SAAV,EAAqB;IAC3D,IAAIW,YAAY,GAAG,EAAnB;;IACA,KAAK,IAAIV,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACC,MAAhC,EAAwCF,EAAE,EAA1C,EAA8C;MAC1CU,YAAY,CAACV,EAAE,GAAG,CAAN,CAAZ,GAAuBC,SAAS,CAACD,EAAD,CAAhC;IACH;;IACD,OAAO,IAAIvH,mBAAmB,CAACuI,iBAAxB,CAA0C,KAAK5E,iBAAL,EAA1C,EAAoE,KAAKP,uBAAL,CAA6B8E,KAA7B,CAAmC,IAAnC,EAAyCtI,OAAO,CAACuI,aAAR,CAAsB,CAACb,SAAD,CAAtB,EAAmC1H,OAAO,CAACwI,MAAR,CAAeH,YAAf,CAAnC,EAAiE,KAAjE,CAAzC,CAApE,CAAP;EACH,CAND;;EAOAtI,SAAS,CAACmB,SAAV,CAAoBwH,uBAApB,GAA8C,UAAUhB,SAAV,EAAqB;IAC/D,IAAIW,YAAY,GAAG,EAAnB;;IACA,KAAK,IAAIV,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACC,MAAhC,EAAwCF,EAAE,EAA1C,EAA8C;MAC1CU,YAAY,CAACV,EAAE,GAAG,CAAN,CAAZ,GAAuBC,SAAS,CAACD,EAAD,CAAhC;IACH;;IACD,OAAO,IAAIvH,mBAAmB,CAACuI,iBAAxB,CAA0C,KAAKhF,eAAL,EAA1C,EAAkE,KAAKH,uBAAL,CAA6B8E,KAA7B,CAAmC,IAAnC,EAAyCtI,OAAO,CAACuI,aAAR,CAAsB,CAACb,SAAD,CAAtB,EAAmC1H,OAAO,CAACwI,MAAR,CAAeH,YAAf,CAAnC,EAAiE,KAAjE,CAAzC,CAAlE,CAAP;EACH,CAND;;EAOAtI,SAAS,CAACmB,SAAV,CAAoBsC,uBAApB,GAA8C,UAAUkE,SAAV,EAAqB;IAC/D,IAAIW,YAAY,GAAG,EAAnB;;IACA,KAAK,IAAIV,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGC,SAAS,CAACC,MAAhC,EAAwCF,EAAE,EAA1C,EAA8C;MAC1CU,YAAY,CAACV,EAAE,GAAG,CAAN,CAAZ,GAAuBC,SAAS,CAACD,EAAD,CAAhC;IACH;;IACD,OAAO,SAASnC,MAAT,CAAgB,KAAKzE,aAAL,CAAmBU,KAAnB,CAAyBmH,WAAzB,EAAhB,EAAwD,IAAxD,EAA8DpD,MAA9D,CAAqE,CAACkC,SAAD,EAAYlC,MAAZ,CAAmB6C,YAAnB,EAAiCN,IAAjC,CAAsC,GAAtC,CAArE,CAAP;EACH,CAND;;EAOAhI,SAAS,CAACmB,SAAV,CAAoByC,eAApB,GAAsC,YAAY;IAC9C,OAAOkF,YAAP;EACH,CAFD;;EAGA9I,SAAS,CAACmB,SAAV,CAAoB6C,iBAApB,GAAwC,YAAY;IAChD,OAAO+E,cAAP;EACH,CAFD;;EAGA/I,SAAS,CAACmB,SAAV,CAAoBoD,eAApB,GAAsC,YAAY;IAC9C,OAAO,KAAKtD,YAAZ;EACH,CAFD;;EAGAjB,SAAS,CAACmB,SAAV,CAAoB6H,OAApB,GAA8B,YAAY;IACtC,OAAO/I,OAAO,CAACgJ,SAAR,CAAkB,IAAlB,EAAwB,KAAK,CAA7B,EAAgC,KAAK,CAArC,EAAwC,YAAY;MACvD,IAAItG,MAAJ;MACA,OAAO1C,OAAO,CAACiJ,WAAR,CAAoB,IAApB,EAA0B,UAAUhE,EAAV,EAAc;QAC3C,QAAQA,EAAE,CAACiE,KAAX;UACI,KAAK,CAAL;YACIxG,MAAM,GAAG,KAAKC,SAAL,EAAT;YACA,IAAI,CAAC,KAAKiC,aAAV,EAAyB,OAAO,CAAC;YAAE;YAAH,EAAc,CAAd,CAAP;YACzBlC,MAAM,CAACuF,KAAP,CAAa,2BAAb;YACA,OAAO,CAAC;YAAE;YAAH,EAAc,KAAKrD,aAAL,CAAmBuE,KAAnB,EAAd,CAAP;;UACJ,KAAK,CAAL;YACIlE,EAAE,CAACmE,IAAH;;YACAnE,EAAE,CAACiE,KAAH,GAAW,CAAX;;UACJ,KAAK,CAAL;YACI,IAAI,KAAKlF,uBAAT,EAAkC;cAC9BtB,MAAM,CAACuF,KAAP,CAAa,iCAAb;cACA,KAAKjE,uBAAL;YACH;;YACD,IAAI,CAAC,KAAK/B,OAAV,EAAmB,OAAO,CAAC;YAAE;YAAH,EAAc,CAAd,CAAP;;YACnB,IAAI,KAAKiF,WAAT,EAAsB;cAClBxE,MAAM,CAACuF,KAAP,CAAa,6BAAb;cACA,KAAKf,WAAL,CAAiBmC,cAAjB,CAAgC,WAAhC,EAA6C,KAAKpH,OAAL,CAAaiB,SAA1D;cACA,KAAKgE,WAAL,CAAiBmC,cAAjB,CAAgC,MAAhC,EAAwC,KAAKpH,OAAL,CAAakB,OAArD;YACH;;YACDT,MAAM,CAACuF,KAAP,CAAa,uBAAb;YACA,KAAKhG,OAAL,CAAakB,OAAb;YACA,OAAO,CAAC;YAAE;YAAH,EAAc,KAAKlB,OAAL,CAAaqH,OAA3B,CAAP;;UACJ,KAAK,CAAL;YACIrE,EAAE,CAACmE,IAAH;;YACAnE,EAAE,CAACiE,KAAH,GAAW,CAAX;;UACJ,KAAK,CAAL;YACI,OAAO,KAAK/G,OAAZ;YACA,OAAO,KAAKP,aAAZ;YACA,OAAO,KAAKE,WAAZ;YACA,OAAO,KAAKG,OAAZ;YACA,OAAO,KAAKZ,SAAZ;YACA,OAAO,KAAKuD,aAAZ;YACA,OAAO,KAAKsC,WAAZ;YACA,OAAO,KAAKlD,uBAAZ;YACAtB,MAAM,CAACuF,KAAP,CAAa,+BAAb;YACA,OAAO,CAAC;YAAE;YAAH,CAAP;QApCR;MAsCH,CAvCM,CAAP;IAwCH,CA1CM,CAAP;EA2CH,CA5CD;;EA6CA,OAAOlI,SAAP;AACH,CArP8B,EAA/B;;AAsPAF,OAAO,CAACE,SAAR,GAAoBA,SAApB"},"metadata":{},"sourceType":"script"}
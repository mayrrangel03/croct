"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SessionPatch = void 0;
var tslib_1 = require("tslib");
var activeRecord_1 = require("../activeRecord");
var SessionPatch = /** @class */ (function (_super) {
    tslib_1.__extends(SessionPatch, _super);
    function SessionPatch(tracker) {
        var _this = _super.call(this) || this;
        _this.tracker = tracker;
        return _this;
    }
    SessionPatch.prototype.save = function () {
        if (!this.isDirty()) {
            // Empty patch
            return Promise.resolve({
                type: 'sessionAttributesChanged',
                patch: { operations: [] },
            });
        }
        var promise = this.tracker.track({
            type: 'sessionAttributesChanged',
            patch: this.buildPatch(),
        });
        this.reset();
        return promise;
    };
    return SessionPatch;
}(activeRecord_1.ActiveRecord));
exports.SessionPatch = SessionPatch;
